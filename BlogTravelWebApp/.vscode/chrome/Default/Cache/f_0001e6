var glb=glb||{};glb.comentarios=glb.comentarios||{};glb.comentarios.getJqueryComentarios=function(){var jQueryFound=window.jQueryComentarios||window.jQuery;var rePontos=new RegExp("\\.","g");var jQueryFoundVersion=parseInt(jQueryFound.fn.jquery.replace(rePontos,""));if(jQueryFoundVersion>183){throw new Error("Versao do jQuery nao suportada para comentarios. E necessario 1.8.3 ou inferior.")}return jQueryFound};glbComentarios = {}; glbComentarios.templates = {"formulario.tpl":"<div class=\"glbComentarios-formulario-aberto\">    <div class=\"glbComentarios-dados-form\">        <div class=\"glbComentarios-dados-form-interno\">            <div class=\"glbComentarios-usuario-anonimo-avatar\">                <img class=\"glbComentarios-usuario-avatar\" src=\"data:image\/gif;base64,R0lGODlhAQABAIAAAAAAAP\/\/\/yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"\/>            <\/div>            <div class=\"glbComentarios-texto-wrapper\">                <textarea rows=\"0\" cols=\"0\" class=\"glbComentarios-widget-comentarios-texto\" placeholder=\"Escreva um coment\u00e1rio...\"><\/textarea>            <\/div>            <button type=\"button\" class=\"glbComentarios-botaoEnviar\">Enviar<\/button>            <div class=\"glbComentarios-captcha\"><\/div>        <\/div>    <\/div><\/div>","main.tpl":"<div class=\"glbComentarios-header\">    <div class=\"glbComentarios-contador\"><\/div>    <div class=\"glbComentarios-texto-contador glbComentarios-zerado\">Seja o primeiro a comentar<\/div><\/div><p class=\"glbComentarios-disclaimer\">    Os coment\u00e1rios s\u00e3o de responsabilidade exclusiva de seus autores e n\u00e3o representam a opini\u00e3o deste site. Se achar algo que viole os    <a class=\"glbComentarios-link\" id=\"glbComentarios-termo\" href=\"https:\/\/login.globo.com\/termosUso\/3004\" target=\"_blank\">termos de uso<\/a>, denuncie. Leia as <a class=\"glbComentarios-link gui-color-primary\" id=\"glbComentarios-perguntas\" href=\"http:\/\/ajudacomentarios.globo.com\" target=\"_blank\">perguntas mais frequentes<\/a> para saber o que \u00e9 impr\u00f3prio ou ilegal.<\/p><div class=\"glbComentarios-formulario glbComentarios-sem-captcha\">{{{form_template}}}<\/div><div class=\"glbComentarios-aba glbComentarios-sem-ratings\">    <p class=\"recentes\"><\/p>    <p class=\"populares\"><\/p><\/div><div class=\"glbComentarios-lista glbComentarios-lista-recentes\">{{{lista_template}}}<\/div><div class=\"glbComentarios-lista glbComentarios-lista-populares\" style=\"display:none\">{{{lista_template}}}<\/div>","lista.tpl":"<div class=\"glbComentarios-aba glbComentarios-sem-ratings interno\">    <p class=\"recentes glbComentarios-barra-cor-produto\" style=\"\">recentes<\/p>    <p class=\"populares\">populares<\/p><\/div><ul class=\"glbComentarios-lista-todos\">    <input type=\"hidden\" name=\"url-post-interatividade\" value=\"{{urlPostInteratividade}}\">    <input type=\"hidden\" name=\"url-get-interatividade\" value=\"{{ urlInteratividade }}\">    <input type=\"hidden\" name=\"agregador\" value=\"{{ agregador }}\">{{#itens}}    <li id=\"comentario-{{idComentario}}\" itemscope        itemtype=\"http:\/\/schema.org\/UserComments\"        data-comentario-qtd_replies=\"{{qtd_replies}}\"         data-comentario-id=\"comentario-{{idComentario}}\"         data-interatividade-id=\"{{idInteratividade}}\"         {{#compartilhado}}            class=\"comentario-compartilhado\"        {{\/compartilhado}}{{#Usuario}}         data-usuario-id=\"usuario-{{usuarioId}}\"         data-usuario-sexo=\"{{sexo}}\"         data-usuario-avatarimgurl=\"{{avatarImgUrl}}\"         data-usuario-oficial=\"{{usuarioOficial}}\" >            <div class=\"glbComentarios-conteudo\">                <div class=\"glbComentarios-conteudo-interno\">                    <div class=\"glbComentarios-usuario-anonimo-avatar\">                        <img class=\"glbComentarios-usuario-avatar\" src=\"data:image\/gif;base64,R0lGODlhAQABAIAAAAAAAP\/\/\/yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"\/>                    <\/div>                    <div itemprop=\"creator\" itemscope itemtype=\"http:\/\/schema.org\/Person\" class=\"glbComentarios-dados-usuario\">                        <strong itemprop=\"name\" class=\"glbComentarios-dados-usuario-nome\" title=\"{{nomeFormatado}}\">{{nomeFormatado}}<\/strong>                        <div class=\"glbComentarios-btn-denunciar-wrapper\" data-denunciar-usuario-id=\"denunciar-usuario-{{usuarioId}}\">                            <button type=\"button\" class=\"glbComentarios-bt-denunciar-sim\">denunciar<\/button>                            <svg class=\"glbComentarios-btn glbComentarios-bt-denunciar\"version=\"1.1\" id=\"Layer_1\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" xmlns:xlink=\"http:\/\/www.w3.org\/1999\/xlink\" x=\"0px\" y=\"0px\"                                    width=\"13px\" height=\"13px\" viewBox=\"0 0 13 13\" enable-background=\"new 0 0 13 13\" xml:space=\"preserve\">                            <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" fill=\"#CCCCCC\" d=\"M10.7,1.5c2.7,2.3,3.1,6.4,0.8,9.2s-6.4,3.1-9.2,0.8                                    s-3.1-6.4-0.8-9.2C3.8-0.4,7.9-0.8,10.7,1.5z M10.2,9.7c1.6-1.9,1.5-4.6,0-6.3L4,10.7C6,11.9,8.7,11.5,10.2,9.7z M2.8,9.7L9,2.3                                    c-2-1.2-4.7-0.8-6.3,1C1.2,5.2,1.2,7.9,2.8,9.7z\"\/>                            <\/svg>                        <\/div>                        {{#usuarioOficial}}                            <p class=\"usuario-oficial\">usu\u00e1rio oficial {{#usuarioOficialFuncao}}<span class=\"funcao\">({{usuarioOficialFuncao}})<\/span>{{\/usuarioOficialFuncao}}<\/p>                        {{\/usuarioOficial}}{{\/Usuario}}                    <div class=\"glbComentarios-data\">{{^qtd_replies}}                        <abbr itemprop=\"commentTime\" title=\"{{dataCadastro}}\" class=\"data cadastro\">{{dataCadastro}}<\/abbr>{{\/qtd_replies}}{{#qtd_replies}}                        <abbr itemprop=\"commentTime\" title=\"{{dataCadastro}}\" class=\"data cadastro no-reduced\">{{dataCadastro}}<\/abbr>                        <abbr itemprop=\"commentTime\" title=\"\" class=\"data cadastro reduced\">&nbsp;<\/abbr>{{\/qtd_replies}}                    <\/div>                    <p class=\"glbComentarios-texto-comentario\" itemprop=\"commentText\">{{texto}}<\/p>                    <div class=\"glbComentarios-btns-thumb-share {{#temInteratividade}}tem-interatividade{{\/temInteratividade}}\">{{#temInteratividade}}                        <button type=\"button\" class=\"glbComentarios-btn glbComentarios-thumbs glbComentarios-thumbs-up voted\" data-opcao-id=\"{{idThumbsUp}}\">0<\/button>                        <button type=\"button\" class=\"glbComentarios-btn glbComentarios-thumbs glbComentarios-thumbs-down voted\" data-opcao-id=\"{{idThumbsDown}}\">0<\/button>{{\/temInteratividade}}                        <div class=\"glbComentarios-barra-share glbComentarios-share-{{idComentario}}\" data-comentario-id=\"{{idComentario}}\"><\/div>                    <\/div>                <\/div>                <div class=\"glbComentarios-lista-resposta\" data-total-replies=\"{{qtd_replies}}\">                    {{{_criaBotaoPaginacaoResposta}}}                    <ul class=\"glbComentarios-lista-resposta-todos\">                        {{#replies}}                            {{>reply}}                        {{\/replies}}                    <\/ul>                <\/div>            <\/div>        <\/div>    <\/li>{{\/itens}}<\/ul >"};if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function($){var Captcha={};Captcha.listaCaptcha=[];Captcha.options={theme:"custom",lang:"pt"};Captcha.load=function(idRecaptcha){this.elemento.find(".glbComentarios-captcha").recaptchaGoogle({idCaptchaNaPagina:idRecaptcha});this.elemento.find(".glbComentarios-captcha").trigger("recaptchaGoogle.createCaptcha")};Captcha.seleciona=function(elemento,comentarioPai){this.elemento=elemento;var container=$(".recaptcha_container");var elementoFormulario=this.elemento.closest(".glbComentarios-formulario");var containerFormulario=container.closest(".glbComentarios-formulario-resposta");if(!elementoFormulario.length){elementoFormulario=this.elemento.closest(".glbComentarios-formulario-resposta");containerFormulario=container.closest(".glbComentarios-formulario")}containerFormulario.addClass("glbComentarios-sem-captcha");elementoFormulario.removeClass("glbComentarios-sem-captcha");container.find("#recaptcha_image").attr("id","novoImagem");container.find("#recaptcha_response_field").attr({id:"novoResponseField",name:"novoResponseField"});container.find("#recaptcha_challenge_field_holder").attr("id","novoRecaptchaHolder");container.find("#recaptcha_challenge_field").attr({id:"novoChallengeField",name:"novoChallengeField"});this.load(comentarioPai)};window.Captcha=Captcha})(glb.comentarios.getJqueryComentarios());/*! Kizzy - a cross-browser LocalStorage API
  * Copyright: Dustin Diaz 2011
  * https://github.com/ded/kizzy
  * License: MIT
  */
;!function(win,doc,store){function noop(){}var hasLocalStorage,html5=0,writeThrough=function(){return 1};try{hasLocalStorage=!!localStorage||!!globalStorage;if(!localStorage){localStorage=globalStorage[store]}html5=1}catch(ex1){html5=0;try{if(doc.documentElement.addBehavior){html5=0;hasLocalStorage=1;var dataStore=doc.documentElement;dataStore.addBehavior("#default#userData");dataStore.load(store);var xmlDoc=dataStore.xmlDocument;var xmlDocEl=xmlDoc.documentElement}}catch(ex2){hasLocalStorage=false}}var setLocalStorage=noop,getLocalStorage=noop,removeLocalStorage=noop,clearLocalStorage=noop;if(hasLocalStorage){setLocalStorage=html5?html5setLocalStorage:setUserData;getLocalStorage=html5?html5getLocalStorage:getUserData;removeLocalStorage=html5?html5removeLocalStorage:removeUserData;clearLocalStorage=html5?html5clearLocalStorage:clearUserData;writeThrough=function(inst){try{var v=JSON.stringify(inst._);if(v=="{}"){removeLocalStorage(inst.ns)}else{setLocalStorage(inst.ns,v)}return 1}catch(x){return 0}}}function time(){return +new Date()}function checkExpiry(inst,k){if(inst._[k]&&inst._[k].e&&inst._[k].e<time()){inst.remove(k)}}function isNumber(n){return typeof n==="number"&&isFinite(n)}function html5getLocalStorage(k){return localStorage[k]}function html5setLocalStorage(k,v){localStorage[k]=v;return v}function html5removeLocalStorage(k){delete localStorage[k]}function html5clearLocalStorage(){localStorage.clear()}function getNodeByName(name){var childNodes=xmlDocEl.childNodes,node,returnVal=null;for(var i=0,len=childNodes.length;i<len;i++){node=childNodes.item(i);if(node.getAttribute("key")==name){returnVal=node;break}}return returnVal}function getUserData(name){var node=getNodeByName(name);var returnVal=null;if(node){returnVal=node.getAttribute("value")}return returnVal}function setUserData(name,value){var node=getNodeByName(name);if(!node){node=xmlDoc.createNode(1,"item","");node.setAttribute("key",name);node.setAttribute("value",value);xmlDocEl.appendChild(node)}else{node.setAttribute("value",value)}dataStore.save(store);return value}function removeUserData(name){getNodeByName(name)&&xmlDocEl.removeChild(node);dataStore.save(store)}function clearUserData(){while(xmlDocEl.firstChild){xmlDocEl.removeChild(xmlDocEl.firstChild)}dataStore.save(store)}function _Kizzy(){this._={}}_Kizzy.prototype={set:function(k,v,optTtl){this._[k]={value:v,e:isNumber(optTtl)?time()+optTtl:0};writeThrough(this)||this.remove(k);return v},get:function(k){checkExpiry(this,k);return this._[k]?this._[k].value:undefined},remove:function(k){delete this._[k];writeThrough(this)},clear:function(){this._={};writeThrough(this)},clearExpireds:function(){for(var k in this._){checkExpiry(this,k)}writeThrough(this)}};function Kizzy(ns){this.ns=ns;this._=JSON.parse(getLocalStorage(ns)||"{}")}Kizzy.prototype=_Kizzy.prototype;function kizzy(ns){return new Kizzy(ns)}kizzy.remove=removeLocalStorage;kizzy.clear=clearLocalStorage;win.kizzy=kizzy;typeof module!=="undefined"&&module.exports&&(module.exports.cache=kizzy)}(this,document,document.domain);/*!
 * jQuery blockUI plugin
 * Version 2.38 (29-MAR-2011)
 * @requires jQuery v1.2.3 or later
 *
 * Examples at: http://malsup.com/jquery/block/
 * Copyright (c) 2007-2010 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
 */
;(function($){if(/1\.(0|1|2)\.(0|1|2)/.test($.fn.jquery)||/^1.1/.test($.fn.jquery)){if(window.console&&console.log){}return}$.fn._fadeIn=$.fn.fadeIn;var noOp=function(){};var mode=document.documentMode||0;var setExpr=$.browser.msie&&(($.browser.version<8&&!mode)||mode<8);var ie6=$.browser.msie&&/MSIE 6.0/.test(navigator.userAgent)&&!mode;$.blockUI=function(opts){install(window,opts)};$.unblockUI=function(opts){remove(window,opts)};$.growlUI=function(title,message,timeout,onClose){var $m=$('<div class="growlUI"></div>');if(title){$m.append("<h1>"+title+"</h1>")}if(message){$m.append("<h2>"+message+"</h2>")}if(timeout==undefined){timeout=3000}$.blockUI({message:$m,fadeIn:700,fadeOut:1000,centerY:false,timeout:timeout,showOverlay:false,onUnblock:onClose,css:$.blockUI.defaults.growlCSS})};$.fn.block=function(opts){return this.unblock({fadeOut:0}).each(function(){if($.css(this,"position")=="static"){this.style.position="relative"}if($.browser.msie){this.style.zoom=1}install(this,opts)})};$.fn.unblock=function(opts){return this.each(function(){remove(this,opts)})};$.blockUI.version=2.38;$.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:0.6,cursor:"wait"},growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:0.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1000,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,applyPlatformOpacityRules:true,onBlock:null,onUnblock:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg"};var pageBlock=null;var pageBlockEls=[];function install(el,opts){var full=(el==window);var msg=opts&&opts.message!==undefined?opts.message:undefined;opts=$.extend({},$.blockUI.defaults,opts||{});opts.overlayCSS=$.extend({},$.blockUI.defaults.overlayCSS,opts.overlayCSS||{});var css=$.extend({},$.blockUI.defaults.css,opts.css||{});var themedCSS=$.extend({},$.blockUI.defaults.themedCSS,opts.themedCSS||{});msg=msg===undefined?opts.message:msg;if(full&&pageBlock){remove(window,{fadeOut:0})}if(msg&&typeof msg!="string"&&(msg.parentNode||msg.jquery)){var node=msg.jquery?msg[0]:msg;var data={};$(el).data("blockUI.history",data);data.el=node;data.parent=node.parentNode;data.display=node.style.display;data.position=node.style.position;if(data.parent){data.parent.removeChild(node)}}var z=opts.baseZ;var lyr1=($.browser.msie||opts.forceIframe)?$('<iframe class="blockUI" style="z-index:'+(z++)+';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+opts.iframeSrc+'"></iframe>'):$('<div class="blockUI" style="display:none"></div>');var lyr2=opts.theme?$('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+(z++)+';display:none"></div>'):$('<div class="blockUI blockOverlay" style="z-index:'+(z++)+';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');var lyr3,s;if(opts.theme&&full){s='<div class="blockUI '+opts.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+z+';display:none;position:fixed"><div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||"&nbsp;")+'</div><div class="ui-widget-content ui-dialog-content"></div></div>'}else{if(opts.theme){s='<div class="blockUI '+opts.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+z+';display:none;position:absolute"><div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||"&nbsp;")+'</div><div class="ui-widget-content ui-dialog-content"></div></div>'}else{if(full){s='<div class="blockUI '+opts.blockMsgClass+' blockPage" style="z-index:'+z+';display:none;position:fixed"></div>'}else{s='<div class="blockUI '+opts.blockMsgClass+' blockElement" style="z-index:'+z+';display:none;position:absolute"></div>'}}}lyr3=$(s);if(msg){if(opts.theme){lyr3.css(themedCSS);lyr3.addClass("ui-widget-content")}else{lyr3.css(css)}}if(!opts.theme&&(!opts.applyPlatformOpacityRules||!($.browser.mozilla&&/Linux/.test(navigator.platform)))){lyr2.css(opts.overlayCSS)}lyr2.css("position",full?"fixed":"absolute");if($.browser.msie||opts.forceIframe){lyr1.css("opacity",0)}var layers=[lyr1,lyr2,lyr3],$par=full?$("body"):$(el);$.each(layers,function(){this.appendTo($par)});if(opts.theme&&opts.draggable&&$.fn.draggable){lyr3.draggable({handle:".ui-dialog-titlebar",cancel:"li"})}var expr=setExpr&&(!$.boxModel||$("object,embed",full?null:el).length>0);if(ie6||expr){if(full&&opts.allowBodyStretch&&$.boxModel){$("html,body").css("height","100%")}if((ie6||!$.boxModel)&&!full){var t=sz(el,"borderTopWidth"),l=sz(el,"borderLeftWidth");var fixT=t?"(0 - "+t+")":0;var fixL=l?"(0 - "+l+")":0}$.each([lyr1,lyr2,lyr3],function(i,o){var s=o[0].style;s.position="absolute";if(i<2){full?s.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.boxModel?0:"+opts.quirksmodeOffsetHack+') + "px"'):s.setExpression("height",'this.parentNode.offsetHeight + "px"');full?s.setExpression("width",'jQuery.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):s.setExpression("width",'this.parentNode.offsetWidth + "px"');if(fixL){s.setExpression("left",fixL)}if(fixT){s.setExpression("top",fixT)}}else{if(opts.centerY){if(full){s.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"')}s.marginTop=0}else{if(!opts.centerY&&full){var top=(opts.css&&opts.css.top)?parseInt(opts.css.top):0;var expression="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+top+') + "px"';s.setExpression("top",expression)}}}})}if(msg){if(opts.theme){lyr3.find(".ui-widget-content").append(msg)}else{lyr3.append(msg)}if(msg.jquery||msg.nodeType){$(msg).show()}}if(($.browser.msie||opts.forceIframe)&&opts.showOverlay){lyr1.show()}if(opts.fadeIn){var cb=opts.onBlock?opts.onBlock:noOp;var cb1=(opts.showOverlay&&!msg)?cb:noOp;var cb2=msg?cb:noOp;if(opts.showOverlay){lyr2._fadeIn(opts.fadeIn,cb1)}if(msg){lyr3._fadeIn(opts.fadeIn,cb2)}}else{if(opts.showOverlay){lyr2.show()}if(msg){lyr3.show()}if(opts.onBlock){opts.onBlock()}}bind(1,el,opts);if(full){pageBlock=lyr3[0];pageBlockEls=$(":input:enabled:visible",pageBlock);if(opts.focusInput){setTimeout(focus,20)}}else{center(lyr3[0],opts.centerX,opts.centerY)}if(opts.timeout){var to=setTimeout(function(){full?$.unblockUI(opts):$(el).unblock(opts)},opts.timeout);$(el).data("blockUI.timeout",to)}}function remove(el,opts){var full=(el==window);var $el=$(el);var data=$el.data("blockUI.history");var to=$el.data("blockUI.timeout");if(to){clearTimeout(to);$el.removeData("blockUI.timeout")}opts=$.extend({},$.blockUI.defaults,opts||{});bind(0,el,opts);var els;if(full){els=$("body").children().filter(".blockUI").add("body > .blockUI")}else{els=$(".blockUI",el)}if(full){pageBlock=pageBlockEls=null}if(opts.fadeOut){els.fadeOut(opts.fadeOut);setTimeout(function(){reset(els,data,opts,el)},opts.fadeOut)}else{reset(els,data,opts,el)}}function reset(els,data,opts,el){els.each(function(i,o){if(this.parentNode){this.parentNode.removeChild(this)}});if(data&&data.el){data.el.style.display=data.display;data.el.style.position=data.position;if(data.parent){data.parent.appendChild(data.el)}$(el).removeData("blockUI.history")}if(typeof opts.onUnblock=="function"){opts.onUnblock(el,opts)}}function bind(b,el,opts){var full=el==window,$el=$(el);if(!b&&(full&&!pageBlock||!full&&!$el.data("blockUI.isBlocked"))){return}if(!full){$el.data("blockUI.isBlocked",b)}if(!opts.bindEvents||(b&&!opts.showOverlay)){return}var events="mousedown mouseup keydown keypress";b?$(document).bind(events,opts,handler):$(document).unbind(events,handler)}function handler(e){if(e.keyCode&&e.keyCode==9){if(pageBlock&&e.data.constrainTabKey){var els=pageBlockEls;var fwd=!e.shiftKey&&e.target===els[els.length-1];var back=e.shiftKey&&e.target===els[0];if(fwd||back){setTimeout(function(){focus(back)},10);return false}}}var opts=e.data;if($(e.target).parents("div."+opts.blockMsgClass).length>0){return true}return $(e.target).parents().children().filter("div.blockUI").length==0}function focus(back){if(!pageBlockEls){return}var e=pageBlockEls[back===true?pageBlockEls.length-1:0];if(e){e.focus()}}function center(el,x,y){var p=el.parentNode,s=el.style;var l=((p.offsetWidth-el.offsetWidth)/2)-sz(p,"borderLeftWidth");var t=((p.offsetHeight-el.offsetHeight)/2)-sz(p,"borderTopWidth");if(x){s.left=l>0?(l+"px"):"0"}if(y){s.top=t>0?(t+"px"):"0"}}function sz(el,p){return parseInt($.css(el,p))||0}})(glb.comentarios.getJqueryComentarios());(function(jQuery,$){jQuery.fn.extend({elastic:function(){var mimics=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each(function(){if(this.type!=="textarea"){return false}var $textarea=jQuery(this),$twin=jQuery("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}),lineHeight=parseInt($textarea.css("line-height"),10)||parseInt($textarea.css("font-size"),"10"),minheight=parseInt($textarea.css("height"),10)||lineHeight*3,maxheight=parseInt($textarea.css("max-height"),10)||Number.MAX_VALUE,goalheight=0;if(maxheight<0){maxheight=Number.MAX_VALUE}$twin.appendTo($textarea.parent());var i=mimics.length;while(i--){$twin.css(mimics[i].toString(),$textarea.css(mimics[i].toString()))}function rebind(){$(window).unbind("resize");$textarea.unbind("resize");bindResize(rebind2)}function rebind2(){$(window).unbind("resize");$textarea.unbind("resize");bindResize(setTwinWidth)}function setTwinWidth(){var curatedWidth=Math.floor(parseInt($textarea.width(),10));if($twin.width()!==curatedWidth){$twin.css({width:curatedWidth+"px"});update(true)}$(window).unbind("resize");$textarea.unbind("resize");bindResize(rebind)}function setHeightAndOverflow(height,overflow){var curratedHeight=Math.floor(parseInt(height,10));if($textarea.height()!==curratedHeight){$textarea.css({height:curratedHeight+"px",overflow:overflow});$textarea.trigger("resize")}}function update(forced){var textareaContent=$textarea.val().replace(/&/g,"&amp;").replace(/ {2}/g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />");var twinContent=$twin.html().replace(/<br>/ig,"<br />");if(forced||textareaContent+"&nbsp;"!==twinContent){$twin.html(textareaContent+"&nbsp;");if(Math.abs($twin.height()+lineHeight-$textarea.height())>3){var goalheight=$twin.height();if(goalheight>=maxheight){setHeightAndOverflow(maxheight,"auto")}else{if(goalheight<=minheight){setHeightAndOverflow(minheight,"hidden")}else{setHeightAndOverflow(goalheight,"hidden")}}}}}$textarea.css({overflow:"hidden"});$textarea.bind("keyup change cut paste",function(){update()});function bindResize(func){$(window).bind("resize",func);$textarea.bind("resize",func)}$textarea.bind("update",update);bindResize(setTwinWidth);$textarea.bind("blur",function(){if($twin.height()<maxheight){if($twin.height()>minheight){$textarea.height($twin.height())}else{$textarea.height(minheight)}}});$textarea.bind("input paste",function(e){setTimeout(update,250)});update()})}})})(glb.comentarios.getJqueryComentarios(),glb.comentarios.getJqueryComentarios());(function($){function noop(){}function genericCallback(data){lastValue=[data]}function callIfDefined(method,object,parameters,returnFlag){try{returnFlag=method&&method.apply(object.context||object,parameters)}catch(_){returnFlag=!1}return returnFlag}function qMarkOrAmp(url){return/\?/.test(url)?"&":"?"}var STR_ASYNC="async",STR_CHARSET="charset",STR_EMPTY="",STR_ERROR="error",STR_INSERT_BEFORE="insertBefore",STR_JQUERY_JSONP="_jqjsp",STR_ON="on",STR_ON_CLICK=STR_ON+"click",STR_ON_ERROR=STR_ON+STR_ERROR,STR_ON_LOAD=STR_ON+"load",STR_ON_READY_STATE_CHANGE=STR_ON+"readystatechange",STR_READY_STATE="readyState",STR_REMOVE_CHILD="removeChild",STR_SCRIPT_TAG="<script>",STR_SUCCESS="success",STR_TIMEOUT="timeout",win=window,head=$("head")[0]||document.documentElement,pageCache={},count=0,lastValue,xOptionsDefaults={callback:STR_JQUERY_JSONP,url:location.href},opera=win.opera;function jsonp(xOptions){xOptions=$.extend({},xOptionsDefaults,xOptions);var completeCallback=xOptions.complete,dataFilter=xOptions.dataFilter,callbackParameter=xOptions.callbackParameter,successCallbackName=xOptions.callback,cacheFlag=xOptions.cache,pageCacheFlag=xOptions.pageCache,charset=xOptions.charset,url=xOptions.url,data=xOptions.data,timeout=xOptions.timeout,pageCached,done=0,cleanUp=noop,supportOnload,supportOnreadystatechange,script,scriptAfter,timeoutTimer;xOptions.abort=function(){!(done++)&&cleanUp()};if(callIfDefined(xOptions.beforeSend,xOptions,[xOptions])===!1||done){return xOptions}url=url||STR_EMPTY;data=data?((typeof data)=="string"?data:$.param(data,xOptions.traditional)):STR_EMPTY;url+=data?(qMarkOrAmp(url)+data):STR_EMPTY;callbackParameter&&(url+=qMarkOrAmp(url)+encodeURIComponent(callbackParameter)+"=?");!cacheFlag&&!pageCacheFlag&&(url+=qMarkOrAmp(url)+"_"+(new Date()).getTime()+"=");url=url.replace(/=\?(&|$)/,"="+successCallbackName+"$1");function notifySuccess(json){if(!(done++)){cleanUp();pageCacheFlag&&(pageCache[url]={s:[json]});dataFilter&&(json=dataFilter.apply(xOptions,[json]));callIfDefined(xOptions.success,xOptions,[json,STR_SUCCESS]);callIfDefined(completeCallback,xOptions,[xOptions,STR_SUCCESS])}}function notifyError(type){if(!(done++)){cleanUp();pageCacheFlag&&type!=STR_TIMEOUT&&(pageCache[url]=type);callIfDefined(xOptions.error,xOptions,[xOptions,type]);callIfDefined(completeCallback,xOptions,[xOptions,type])}}if(pageCacheFlag&&(pageCached=pageCache[url])){pageCached.s?notifySuccess(pageCached.s[0]):notifyError(pageCached)}else{win[successCallbackName]=genericCallback;script=$(STR_SCRIPT_TAG)[0];script.id=STR_JQUERY_JSONP+count++;if(charset){script[STR_CHARSET]=charset}opera&&opera.version()<11.6?((scriptAfter=$(STR_SCRIPT_TAG)[0]).text="document.getElementById('"+script.id+"')."+STR_ON_ERROR+"()"):(script[STR_ASYNC]=STR_ASYNC);if(!(STR_ON_LOAD in script)&&(STR_ON_READY_STATE_CHANGE in script)){script.htmlFor=script.id;script.event=STR_ON_CLICK}script[STR_ON_LOAD]=script[STR_ON_ERROR]=script[STR_ON_READY_STATE_CHANGE]=function(result){if(!script[STR_READY_STATE]||/loaded|complete/.test(script[STR_READY_STATE])){try{script[STR_ON_CLICK]&&script[STR_ON_CLICK]()}catch(_){}result=lastValue;lastValue=0;result?notifySuccess(result[0]):notifyError(STR_ERROR)}};script.src=url;cleanUp=function(i){timeoutTimer&&clearTimeout(timeoutTimer);script[STR_ON_READY_STATE_CHANGE]=script[STR_ON_LOAD]=script[STR_ON_ERROR]=null;head[STR_REMOVE_CHILD](script);scriptAfter&&head[STR_REMOVE_CHILD](scriptAfter)};head[STR_INSERT_BEFORE](script,head.firstChild);scriptAfter&&head[STR_INSERT_BEFORE](scriptAfter,head.firstChild);timeoutTimer=timeout>0&&setTimeout(function(){notifyError(STR_TIMEOUT)},timeout)}return xOptions}jsonp.setup=function(xOptions){$.extend(xOptionsDefaults,xOptions)};$.jsonp=jsonp})(glb.comentarios.getJqueryComentarios());(function(c){c.fn.NobleCount=function(i,h){var j;var g=false;if(typeof i=="string"){j=c.extend({},c.fn.NobleCount.settings,h);if(typeof h!="undefined"){g=((typeof h.max_chars=="number")?true:false)}return this.each(function(){var k=c(this);f(k,i,j,g)})}return this};c.fn.NobleCount.settings={on_negative:null,on_positive:null,on_update:null,max_chars:140,block_negative:false,cloak:false,in_dom:false};function f(g,m,n,h){var l=n.max_chars;var j=c(m);if(!h){var k=j.text();var i=(/^[1-9]\d*$/).test(k);if(i){l=k}}b(g,j,n,l,true);c(g).keydown(function(o){b(g,j,n,l,false);if(a(o,g,n,l)==false){return false}});c(g).keyup(function(o){b(g,j,n,l,false);if(a(o,g,n,l)==false){return false}})}function a(k,g,l,j){if(l.block_negative){var h=k.which;var i;if(typeof document.selection!="undefined"){i=(document.selection.createRange().text.length>0)}else{i=(g[0].selectionStart!=g[0].selectionEnd)}if((!((e(g,j)<1)&&(h>47||h==32||h==0||h==13)&&!k.ctrlKey&&!k.altKey&&!i))==false){return false}}return true}function e(g,h){return h-(c(g).val()).length}function b(g,i,l,j,h){var k=e(g,j);if(k<0){d(l.on_negative,l.on_positive,g,i,l,k)}else{d(l.on_positive,l.on_negative,g,i,l,k)}if(l.cloak){if(l.in_dom){i.attr("data-noblecount",k)}}else{i.text(k)}if(!h&&jQuery.isFunction(l.on_update)){l.on_update(g,i,l,k)}}function d(i,g,h,j,l,k){if(i!=null){if(typeof i=="string"){j.addClass(i)}else{if(jQuery.isFunction(i)){i(h,j,l,k)}}}if(g!=null){if(typeof g=="string"){j.removeClass(g)}}}})(glb.comentarios.getJqueryComentarios());/*!
 * jQuery postMessage - v0.5 - 9/11/2009
 * http://benalman.com/projects/jquery-postmessage-plugin/
 * 
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($){var cache_bust=1,window=this,FALSE=!1,postMessage="postMessage",addEventListener="addEventListener",p_receiveMessage,has_postMessage=window[postMessage]&&!$.browser.opera,is_IE8=($.browser.msie&&$.browser.version==8)||($.browser.msie&&$.browser.version==7&&!!window.postMessage),ie8_iframe,IFRAME_NAME="__post_message",re_hash_postmessage=/^#postmessage\d+&/,re_base_url=/http[s]?:\/\/[^\/]+/;$[postMessage]=function(message,target_url,target){if(!target_url){return}message=typeof message==="string"?message:$.param(message);target=target||parent;var inside_iframe=window.top===target.top;if(has_postMessage&&(!is_IE8||inside_iframe)){target[postMessage](message,target_url.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}else{if(is_IE8&&!inside_iframe&&target.frames[IFRAME_NAME]){target.frames[IFRAME_NAME].sendData(message)}else{if(target_url){target.location=target_url.replace(/#.*$/,"")+"#postmessage"+(+new Date)+(cache_bust++)+"&"+encodeURIComponent(window.location.href.split("#")[0])+"&"+escape(message)}}}};$.receiveMessage=p_receiveMessage=function(callback,source_origin,delay,iframe_url){if(is_IE8&&!ie8_iframe&&iframe_url){ie8_iframe=$("<iframe></iframe>").attr({name:IFRAME_NAME,src:iframe_url,width:0,height:0});$("body").append(ie8_iframe)}if(has_postMessage){var rm_callback=function(e){if((typeof source_origin==="string"&&e.origin!==source_origin)||($.isFunction(source_origin)&&source_origin(e.origin)===FALSE)){return FALSE}callback(e)};if(window.addEventListener){window.addEventListener("message",rm_callback,FALSE)}else{window.attachEvent("onmessage",rm_callback)}}else{delay=typeof delay==="number"?delay:1000;var last_hash=document.location.hash;setInterval(function(){var hash,hash_event,base_url_a,origin,data,e;hash=document.location.hash;if(hash!==last_hash&&re_hash_postmessage.test(hash)){last_hash=hash;hash_event=hash.replace(re_hash_postmessage,"").split("&");if(hash_event.length!==2){return FALSE}base_url_a=re_base_url.exec(decodeURIComponent(hash_event[0]));if(!base_url_a||base_url_a.length!==1){return FALSE}origin=base_url_a[0];data=unescape(hash_event[1]);e={origin:origin,data:data};if((typeof source_origin==="string"&&e.origin!==source_origin)||($.isFunction(source_origin)&&source_origin(e.origin)===FALSE)){return FALSE}callback(e);window.setTimeout(function(){window.location.hash=" "},1000)}},delay)}}})(glb.comentarios.getJqueryComentarios());(function($){var log=$.noop;var janelaAberta=null;var usuario_autenticacao_cadun=null;$.setCookie=function setCookie(c_name,value,expiredays){var exdate=new Date();exdate.setDate(exdate.getDate()+expiredays);document.cookie=c_name+"="+escape(value)+((expiredays==null)?"":";expires="+exdate.toUTCString())};var getCookie=function(cookieName){var results=document.cookie.match("(^|;) ?"+cookieName+"=([^;]*)(;|$)");if(results){return(unescape(results[2]))}return null};$.setCookie=function setCookie(c_name,value,expiredays){var exdate=new Date();exdate.setDate(exdate.getDate()+expiredays);document.cookie=c_name+"="+escape(value)+((expiredays==null)?"":";expires="+exdate.toUTCString())};$.getCookie=function getCookie_ext(cookieName){return getCookie(cookieName)};$.verificaAutenticacao=function(callback){Cadun.authorize("3004",function(usuario){if(usuario.status=="authorized"){$.jsonp({url:"//comentarios.dinamico.globo.com/autenticacao/autorizacao",timeout:5000,callback:"__cwc_autenticacao",success:function(usuarioComentario){callback(usuarioComentario)},error:function(){callback(null)}})}else{callback(null);return}})};$.widget("ui.janelaLogin",{widgetEventPrefix:"login",options:{servico:null,success:null,site:window.location.toString(),evento:"click",id:"random",cache:true,instanciaUnica:true,classes:{verificando:"janelaLogin-abrindo",boxLogin:"janelaLogin-box",autenticado:"janelaLogin-autenticado",boxAberto:"janelaLogin-box-aberto"},urls:{janelaLogin:"https://login.globo.com/login/{servico}?tam=widget",fechabox:"//comentarios.dinamico.globo.com/autenticacao/fechaboxlogin",cadastro:"https://login.globo.com/cadastro/{servico}",logout:"https://login.globo.com/logout"}},_create:function(){if(!(this.options.servico&&$.isFunction(this.options.success))){throw"parametros invalidos para o widget de janela de login"}var url;for(url in this.options.urls){if(this.options.urls.hasOwnProperty(url)){this.options.urls[url]=this.options.urls[url].replace(/\{servico\}/g,this.options.servico)}}if(this.options.id==="random"){this.options.id="login"+this.element.attr("id")+"-"+Math.random()}var self=this;this.element.bind(this.options.evento+".janelaLogin",function(event){self._onclick.call(self,event);return false});this.box=null;this.cadun=Cadun},destroy:function(){this.close();this.element.unbind(this.options.evento+".janelaLogin");$.Widget.prototype.destroy.apply(this,arguments)},check:function(callback){this._trigger("beforecheck");var self=this;$.verificaAutenticacao(function(usuario){self._trigger("check",null,usuario);callback.call(self,usuario)})},opened:function(){return !!this.box},_onclick:function(event){this.show()},show:function(){if(janelaAberta&&this.options.instanciaUnica){janelaAberta.close()}janelaAberta=this;if(this.box){return}this.element.addClass(this.options.classes.verificando);var self=this;this.check(function(usuario){if(usuario){self.element.removeClass(self.options.classes.verificando);self._autenticacao_confirmada.call(self,usuario)}else{self._show()}})},_show:function(){var self=this;var href=encodeURIComponent(location.href);if($(".cadun-modal").length===0){Cadun.login(this.options.servico,href,false,function(){self.element.removeClass(self.options.classes.verificando);self._obtem_dados_usuario()});this.element.addClass(this.options.classes.boxAberto)}},_obtem_dados_usuario:function(){var self=this;var usuario_cadunjs=Cadun.user.me;var avatarURL="";self._obtem_avatar(function(avatar){usuario={nome:usuario_cadunjs.name,email:usuario_cadunjs.email,usuarioId:usuario_cadunjs.id,avatarImgUrl:avatar};self._autenticacao_confirmada.call(self,usuario)},usuario_cadunjs.id)},_obtem_avatar:function(callback,usuario_id){$.jsonp({url:"//comentarios.globo.com/"+usuario_id+"/avatar",timeout:100,cache:true,callback:"__cwc_avatar",success:function(avatar){callback(avatar)},error:function(){callback(null)}})},_autenticacao_confirmada:function(usuario){if(this.options.cache){usuario_autenticacao_cadun=usuario}this.close();if(!this.element.hasClass(this.options.classes.autenticado)){this.element.addClass(this.options.classes.autenticado)}this.options.success.call(this,usuario)},close:function(){if(!this.box){return}this.element.removeClass(this.options.classes.boxAberto);if(this._trigger("close")!==false){this.box.remove()}this.box=null;janelaAberta=null}})})(glb.comentarios.getJqueryComentarios());var Mustache=function(){var _toString=Object.prototype.toString;Array.isArray=Array.isArray||function(obj){return _toString.call(obj)=="[object Array]"};var _trim=String.prototype.trim,trim;if(_trim){trim=function(text){return text==null?"":_trim.call(text)}}else{var trimLeft,trimRight;if((/\S/).test("\xA0")){trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/}else{trimLeft=/^\s+/;trimRight=/\s+$/}trim=function(text){return text==null?"":text.toString().replace(trimLeft,"").replace(trimRight,"")}}var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function escapeHTML(string){return String(string).replace(/&(?!#?\w+;)|[<>"']/g,function(s){return escapeMap[s]||s})}var regexCache={};var Renderer=function(){};Renderer.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(template,context,partials,in_recursion){if(!in_recursion){this.context=context;this.buffer=[]}if(!this.includes("",template)){if(in_recursion){return template}else{this.send(template);return}}template=this.render_pragmas(template);var html=this.render_section(template,context,partials);if(html===false){html=this.render_tags(template,context,partials,in_recursion)}if(in_recursion){return html}else{this.sendLines(html)}},send:function(line){if(line!==""){this.buffer.push(line)}},sendLines:function(text){if(text){var lines=text.split("\n");for(var i=0;i<lines.length;i++){this.send(lines[i])}}},render_pragmas:function(template){if(!this.includes("%",template)){return template}var that=this;var regex=this.getCachedRegex("render_pragmas",function(otag,ctag){return new RegExp(otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+ctag,"g")});return template.replace(regex,function(match,pragma,options){if(!that.pragmas_implemented[pragma]){throw ({message:"This implementation of mustache doesn't understand the '"+pragma+"' pragma"})}that.pragmas[pragma]={};if(options){var opts=options.split("=");that.pragmas[pragma][opts[0]]=opts[1]}return""})},render_partial:function(name,context,partials){name=trim(name);if(!partials||partials[name]===undefined){throw ({message:"unknown_partial '"+name+"'"})}if(!context||typeof context[name]!="object"){return this.render(partials[name],context,partials,true)}return this.render(partials[name],context[name],partials,true)},render_section:function(template,context,partials){if(!this.includes("#",template)&&!this.includes("^",template)){return false}var that=this;var regex=this.getCachedRegex("render_section",function(otag,ctag){return new RegExp("^([\\s\\S]*?)"+otag+"(\\^|\\#)\\s*(.+?)\\s*"+ctag+"\n*([\\s\\S]*?)"+otag+"\\/\\s*\\3\\s*"+ctag+"\\s*([\\s\\S]*)$","g")});return template.replace(regex,function(match,before,type,name,content,after){var renderedBefore=before?that.render_tags(before,context,partials,true):"",renderedAfter=after?that.render(after,context,partials,true):"",renderedContent,value=that.find(name,context);if(type==="^"){if(!value||Array.isArray(value)&&value.length===0){renderedContent=that.render(content,context,partials,true)}else{renderedContent=""}}else{if(type==="#"){if(Array.isArray(value)){renderedContent=that.map(value,function(row){return that.render(content,that.create_context(row),partials,true)}).join("")}else{if(that.is_object(value)){renderedContent=that.render(content,that.create_context(value),partials,true)}else{if(typeof value=="function"){renderedContent=value.call(context,content,function(text){return that.render(text,context,partials,true)})}else{if(value){renderedContent=that.render(content,context,partials,true)}else{renderedContent=""}}}}}}return renderedBefore+renderedContent+renderedAfter})},render_tags:function(template,context,partials,in_recursion){var that=this;var new_regex=function(){return that.getCachedRegex("render_tags",function(otag,ctag){return new RegExp(otag+"(=|!|>|&|\\{|%)?([^#\\^]+?)\\1?"+ctag+"+","g")})};var regex=new_regex();var tag_replace_callback=function(match,operator,name){switch(operator){case"!":return"";case"=":that.set_delimiters(name);regex=new_regex();return"";case">":return that.render_partial(name,context,partials);case"{":case"&":return that.find(name,context);default:return escapeHTML(that.find(name,context))}};var lines=template.split("\n");for(var i=0;i<lines.length;i++){lines[i]=lines[i].replace(regex,tag_replace_callback,this);if(!in_recursion){this.send(lines[i])}}if(in_recursion){return lines.join("\n")}},set_delimiters:function(delimiters){var dels=delimiters.split(" ");this.otag=this.escape_regex(dels[0]);this.ctag=this.escape_regex(dels[1])},escape_regex:function(text){if(!arguments.callee.sRE){var specials=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+specials.join("|\\")+")","g")}return text.replace(arguments.callee.sRE,"\\$1")},find:function(name,context){name=trim(name);function is_kinda_truthy(bool){return bool===false||bool===0||bool}var value;if(name.match(/([a-z_]+)\./ig)){var childValue=this.walk_context(name,context);if(is_kinda_truthy(childValue)){value=childValue}}else{if(is_kinda_truthy(context[name])){value=context[name]}else{if(is_kinda_truthy(this.context[name])){value=this.context[name]}}}if(typeof value=="function"){return value.apply(context)}if(value!==undefined){return value}return""},walk_context:function(name,context){var path=name.split(".");var value_context=(context[path[0]]!=undefined)?context:this.context;var value=value_context[path.shift()];while(value!=undefined&&path.length>0){value_context=value;value=value[path.shift()]}if(typeof value=="function"){return value.apply(value_context)}return value},includes:function(needle,haystack){return haystack.indexOf(this.otag+needle)!=-1},create_context:function(_context){if(this.is_object(_context)){return _context}else{var iterator=".";if(this.pragmas["IMPLICIT-ITERATOR"]){iterator=this.pragmas["IMPLICIT-ITERATOR"].iterator}var ctx={};ctx[iterator]=_context;return ctx}},is_object:function(a){return a&&typeof a=="object"},map:function(array,fn){if(typeof array.map=="function"){return array.map(fn)}else{var r=[];var l=array.length;for(var i=0;i<l;i++){r.push(fn(array[i]))}return r}},getCachedRegex:function(name,generator){var byOtag=regexCache[this.otag];if(!byOtag){byOtag=regexCache[this.otag]={}}var byCtag=byOtag[this.ctag];if(!byCtag){byCtag=byOtag[this.ctag]={}}var regex=byCtag[name];if(!regex){regex=byCtag[name]=generator(this.otag,this.ctag)}return regex}};return({name:"mustache.js",version:"0.4.2",to_html:function(template,view,partials,send_fun){var renderer=new Renderer();if(send_fun){renderer.send=send_fun}renderer.render(template,view||{},partials);if(!send_fun){return renderer.buffer.join("\n")}}})}();(function(jQuery,$){$.easydate={};$.easydate.locales={};$.easydate.locales.enUS={future_format:"%s %t",past_format:"%t %s",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",week:"week",weeks:"weeks",month:"month",months:"months",year:"year",years:"years",yesterday:"yesterday",tomorrow:"tomorrow",now:"just now",ago:"ago","in":"in"};$.easydate.locales.ptBR={future_format:"%s %t",past_format:"%t %s",second:"segundo",seconds:"segundos",minute:"minuto",minutes:"minutos",hour:"hora",hours:"horas",day:"dia",days:"dias",week:"semana",weeks:"semanas",month:"mês",months:"meses",year:"ano",years:"anos",yesterday:"ontem",tomorrow:"amanha",now:"agora",ago:"atrás","in":"em"};var defaults={live:true,set_title:true,format_future:true,format_past:true,units:[{name:"now",limit:5},{name:"second",limit:60,in_seconds:1},{name:"minute",limit:3600,in_seconds:60},{name:"hour",limit:86400,in_seconds:3600},{name:"yesterday",limit:172800,past_only:true},{name:"tomorrow",limit:172800,future_only:true},{name:"day",limit:604800,in_seconds:86400},{name:"week",limit:2629743,in_seconds:604800},{name:"month",limit:31556926,in_seconds:2629743},{name:"year",limit:Infinity,in_seconds:31556926}],uneasy_format:function(date){return date.toLocaleDateString()},locale:$.easydate.locales.enUS};var now_diff=0;var updates={};var paused_updates={};var elements={};function __(str,value,settings){if(!isNaN(value)&&value!=1){str=str+"s"}return settings.locale[str]||str}var pause=$.easydate.pause=function(selector){var p=function(element_id){clearTimeout(updates[element_id]);delete updates[element_id];paused_updates[element_id]=true};if(!selector){for(var element_id in updates){p(element_id)}}else{$(selector).each(function(){var element_id=jQuery.data(this);if(!isNaN(updates[element_id])){p(element_id)}})}};var resume=$.easydate.resume=function(selector){var r=function(element_id){delete paused_updates[element_id];update_time(elements[element_id])};if(!selector){for(var element_id in paused_updates){r(element_id)}}else{$(selector).each(function(){var element_id=jQuery.data(this);if(!isNaN(paused_updates[element_id])){r(element_id)}})}};var set_now=$.easydate.set_now=function(date){var time;if(date instanceof Date){time=date.getTime()}else{time=Date.parse(date)}if(isNaN(time)){return}now_diff=time-(new Date()).getTime();for(var element_id in elements){if(!isNaN[updates[element_id]]){clearTimeout(updates[element_id])}update_time(elements[element_id])}};var get_now=$.easydate.get_now=function(){var now=new Date();now.setTime(now.getTime()+now_diff);return now};var format_date=$.easydate.format_date=function(date,options){var settings=$.extend({},defaults,options);var diff=((get_now().getTime()-date.getTime())/1000);var diff_abs=Math.abs(diff);if(isNaN(diff)){return}if((!settings.format_future&&diff<0)||(!settings.format_past&&diff>0)){return}for(var i in settings.units){var unit=settings.units[i];if((unit.past_only&&diff<0)||(unit.future_only&&diff>0)){continue}if(diff_abs<unit.limit){if(isNaN(unit.in_seconds)){return __(unit.name,NaN,settings)}var val=diff_abs/unit.in_seconds;val=Math.round(val);var format_string;if(diff<0){format_string=__("future_format",NaN,settings).replace("%s",__("in",NaN,settings))}else{format_string=__("past_format",NaN,settings).replace("%s",__("ago",NaN,settings))}return format_string.replace("%t",val+" "+__(unit.name,val,settings))}}return settings.uneasy_format(date)};function get_timeout_delay(date,settings){var now=get_now();var diff=((now.getTime()-date.getTime())/1000);var diff_abs=Math.abs(diff);if(isNaN(diff)){return}var last_limit=0;for(var i in settings.units){var unit=settings.units[i];if((unit.past_only&&diff<0)||(unit.future_only&&diff>0)){continue}if(diff_abs<unit.limit){if(isNaN(unit.in_seconds)){if(diff<0){return(last_limit-diff_abs)*1000+100}else{return(unit.limit-diff_abs)*1000+100}}else{if(diff<0){return(diff_abs%unit.in_seconds)*1000+100}else{return(unit.in_seconds-(diff_abs%unit.in_seconds))*1000+100}}}last_limit=unit.limit}if(diff<0){for(var i=settings.units.length-1;i>=0;i--){var unit=settings.units[i];if(unit.past_only){continue}return(unit.limit-diff_abs)*1000+100}}}function get_date(element,settings){var date=element.data("easydate.date");if(isNaN(date)){var timestamp;var time=Date.parse(timestamp=element.attr("dataCadun"))||Date.parse(timestamp=element.html());if(!isNaN(time)){date=new Date();date.setTime(time);element.data("easydate.date",date);if(settings.set_title&&!element.attr("dataCadun")){element.attr("dataCadun",timestamp)}}}return date}function update_time(element){var settings=element.data("easydate.settings");var element_id=$.data(element[0]);elements[element_id]=element;delete updates[element_id];var date=get_date(element,settings);if(isNaN(date)){return}element.html(format_date(date,settings));if(settings.live){var timeout=get_timeout_delay(date,settings);if(!isNaN(timeout)){if(timeout>2147483647){timeout=2147483647}var id=setTimeout(function(){update_time(element)},Math.round(timeout));updates[element_id]=id}}}$.fn.easydate=function(options){var settings=$.extend({},defaults,options);this.data("easydate.settings",settings);this.removeData("easydate.date");this.each(function(){var element_id=$.data(this);if(!isNaN(updates[element_id])){clearTimeout(updates[element_id]);delete updates[element_id]}update_time($(this))})}})(glb.comentarios.getJqueryComentarios(),glb.comentarios.getJqueryComentarios());(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(glb.comentarios.getJqueryComentarios())}}(function($){$.timeago=function(timestamp){if(timestamp instanceof Date){return inWords(timestamp)}else{if(typeof timestamp==="string"){return inWords($.timeago.parse(timestamp))}else{if(typeof timestamp==="number"){return inWords(new Date(timestamp))}else{return inWords($.timeago.datetime(timestamp))}}}};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:60000,allowFuture:false,localeTitle:false,cutoff:0,strings:{prefixAgo:"há",prefixFromNow:"em",suffixAgo:null,suffixFromNow:null,seconds:"alguns segundos",minute:"um minuto",minutes:"%d minutos",hour:"uma hora",hours:"%d horas",day:"um dia",days:"%d dias",month:"um mês",months:"%d meses",year:"um ano",years:"%d anos",wordSeparator:" ",numbers:[]}},inWords:function(distanceMillis){var $l=this.settings.strings;var prefix=$l.prefixAgo;var suffix=$l.suffixAgo;if(this.settings.allowFuture){if(distanceMillis<0){prefix=$l.prefixFromNow;suffix=$l.suffixFromNow}}var seconds=Math.abs(distanceMillis)/1000;var minutes=seconds/60;var hours=minutes/60;var days=hours/24;var years=days/365;function substitute(stringOrFunction,number){var string=$.isFunction(stringOrFunction)?stringOrFunction(number,distanceMillis):stringOrFunction;var value=($l.numbers&&$l.numbers[number])||number;return string.replace(/%d/i,value)}var words=seconds<45&&substitute($l.seconds,Math.round(seconds))||seconds<90&&substitute($l.minute,1)||minutes<45&&substitute($l.minutes,Math.round(minutes))||minutes<90&&substitute($l.hour,1)||hours<24&&substitute($l.hours,Math.round(hours))||hours<42&&substitute($l.day,1)||days<30&&substitute($l.days,Math.round(days))||days<45&&substitute($l.month,1)||days<365&&substitute($l.months,Math.round(days/30))||years<1.5&&substitute($l.year,1)||substitute($l.years,Math.round(years));var separator=$l.wordSeparator||"";if($l.wordSeparator===undefined){separator=" "}return $.trim([prefix,words,suffix].join(separator))},parse:function(iso8601){var s=$.trim(iso8601);s=s.replace(/\.\d+/,"");s=s.replace(/-/,"/").replace(/-/,"/");s=s.replace(/T/," ").replace(/Z/," UTC");s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(s)},datetime:function(elem){var iso8601=$t.isTime(elem)?$(elem).attr("datetime"):$(elem).attr("title");return $t.parse(iso8601)},isTime:function(elem){return $(elem).get(0).tagName.toLowerCase()==="time"}});var functions={init:function(){var refresh_el=$.proxy(refresh,this);refresh_el();var $s=$t.settings;if($s.refreshMillis>0){this._timeagoInterval=setInterval(refresh_el,$s.refreshMillis)}},update:function(time){var parsedTime=$t.parse(time);$(this).data("timeago",{datetime:parsedTime});if($t.settings.localeTitle){$(this).attr("title",parsedTime.toLocaleString())}refresh.apply(this)},updateFromDOM:function(){$(this).data("timeago",{datetime:$t.parse($t.isTime(this)?$(this).attr("datetime"):$(this).attr("title"))});refresh.apply(this)},dispose:function(){if(this._timeagoInterval){window.clearInterval(this._timeagoInterval);this._timeagoInterval=null}}};$.fn.timeago=function(action,options){var fn=action?functions[action]:functions.init;if(!fn){throw new Error("Unknown function name '"+action+"' for timeago")}this.each(function(){fn.call(this,options)});return this};function refresh(){var data=prepareData(this);var $s=$t.settings;if(!isNaN(data.datetime)){if($s.cutoff===0||distance(data.datetime)<$s.cutoff){$(this).text(inWords(data.datetime))}}return this}function prepareData(element){element=$(element);if(!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());if($t.settings.localeTitle){element.attr("title",element.data("timeago").datetime.toLocaleString())}else{if(text.length>0&&!($t.isTime(element)&&element.attr("title"))){element.attr("title",text)}}}return element.data("timeago")}function inWords(date){return $t.inWords(distance(date))}function distance(date){return(new Date().getTime()-date.getTime())}document.createElement("abbr");document.createElement("time")}));(function($,window){$.safeXDR=function(url,parameters,complete){if(complete){get(url,parameters,complete)}else{getByImage(url,parameters)}};function getByImage(url,parameters){parameters.nocache=new Date().getTime();var imageSrc=url+"?"+$.param(parameters);var image=new Image();image.src=imageSrc}function get(url,parameters,complete){function parseAndInvokeCallback(response){try{response=JSON.parse(response)}catch(err){}complete(response)}if(isIE()){getByXDomainRequest(url,parameters,parseAndInvokeCallback)}else{getByAjax(url,parameters,parseAndInvokeCallback)}}function getByAjax(url,parameters,complete){$.ajax({url:url,type:"GET",data:parameters,cache:false,timeout:500,success:function(response){complete(response)},error:function(){complete()}})}function getByXDomainRequest(url,parameters,complete){parameters.nocache=new Date().getTime();var xdr=new XDomainRequest();if(!xdr){return complete()}xdr.onload=function(){complete(xdr.responseText)};xdr.onerror=function(){complete()};xdr.onprogress=function(){};xdr.ontimeout=function(){complete()};xdr.timeout=500;xdr.open("GET",url+"?"+$.param(parameters));xdr.send()}function isIE(){return window.XDomainRequest}}(glb.comentarios.getJqueryComentarios(),window));(function(global,$){var ONE_DAY_EXPIRATION_TIME=86400000;var ab={server:"",get:function(parameters,callback){var experimentName=parameters.experiment;var defaultValue=parameters.defaultValue;var key,userId;if(parameters.userId){userId=parameters.userId;key="user"+userId+":"+experimentName}else{key="ab:"+experimentName}var url=ab.server+"ab/"+experimentName;var requestParameters={};if(userId){requestParameters.user_id=userId}$.safeXDR(url,requestParameters,function(response){if(response){setCache(key,response);callback(response.result)}else{returnCacheIfError(key,defaultValue,callback)}})},conversion:function(parameters){var url=ab.server+"convert/"+parameters.experiment+"/"+parameters.version;$.safeXDR(url,{})}};function returnCacheIfError(key,defaultValue,callback){var response=getCache(key)||{result:defaultValue};callback(response.result)}function getCache(key){return cache().get(key)}function setCache(key,value){cache().set(key,value,ONE_DAY_EXPIRATION_TIME)}function cache(){return kizzy("globoAB")}global.globoAB=ab}(this,glb.comentarios.getJqueryComentarios()));/*! ShareBar - v3.1.3 - 2016-12-07 - * Copyright (c) 2016 Globo.com; Licensed MIT */
;function ShareBar(a){return this.init(a)}!function(a,b){function c(b){b&&b.preventDefault?b.preventDefault():a.event&&(a.event.returnValue=!1)}function d(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,function(){c.call(a)}):void 0}var e="facebook",f="twitter",g="whatsapp",h="google",i="pinterest",j="email",k=34,l=110,m=4,n=6,o="share-button";ShareBar.prototype={init:function(a){this.eventName=this.getActionName(),this.verifyTouch(),this.createSVG(),this.mergeOptions(a),this.containers=b.querySelectorAll(this.selector),this.createBars()},getActionName:function(){return this.isTouch()?"mouseup":"click"},verifyTouch:function(){var a=b.querySelector("html"),c=this.isTouch(),d=" touch",e=" no-touch";c&&a.className.indexOf(d)===-1?a.className+=d:c||a.className.indexOf(e)!==-1||(a.className+=e)},isTouch:function(){var c=!1;return(void 0!==a.ontouchstart||a.DocumentTouch&&b instanceof DocumentTouch)&&(c=!0),c},createSVG:function(){var a=b.createElement("div");a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg"><symbol viewBox="0 0 500 500" id="icon-email"><title>email</title><path d="M1 387c0 27 23 50 50 50h398c28 0 50-23 50-50V138L300 286c-28 17-70 18-99 0L1 138v249zm228-158c10 5 33 6 42 0 98-71 117-86 209-155-7-6-19-11-31-11H51c-12 0-23 5-31 12l209 154z"/></symbol><symbol viewBox="0 0 500 500" id="icon-facebook"><title>facebook</title><path d="M471 1H29C13 1 1 13 1 29v442c0 16 12 28 28 28h238V306h-65v-75h65v-55c0-65 39-100 97-100 27 0 51 2 58 3v67h-40c-31 0-37 15-37 37v48h74l-10 75h-64v193h126c16 0 28-12 28-28V29c0-16-12-28-28-28z"/></symbol><symbol viewBox="0 0 500 500" id="icon-googleplus"><title>googleplus</title><path d="M333 2H186C88 2 35 47 35 127c0 65 60 109 131 99-17 33 2 57 14 69C82 295 2 338 2 401c0 56 47 97 142 97 102 0 175-56 175-124 0-23-8-43-26-64-32-36-71-46-71-72 0-23 22-34 40-49 27-24 36-54 34-83-3-41-27-65-44-78l37 1 44-27zm-70 364c26 36 7 104-86 104-52 0-117-21-117-81 0-70 103-75 141-75 23 17 46 30 62 52zm-64-162c-45 18-82-10-99-68-15-48-4-94 29-106 44-15 79 10 99 63 21 60 7 95-29 111zm240 10v-59h-35v59h-59v36h59v59h35v-59h60v-36h-60z"/></symbol><symbol viewBox="0 0 500 500" id="icon-pinterest"><title>pinterest</title><path d="M250 1a248 249 0 0 0-100 476 218 218 0 0 1 4-57l33-135s-8-16-8-39c0-37 21-64 48-64 23 0 34 17 34 37 0 23-15 57-22 88-6 26 13 48 39 48 47 0 79-61 79-132 0-55-37-95-104-95-75 0-122 56-122 119 0 22 6 37 16 49 5 5 5 8 4 14l-5 20c-2 6-7 9-13 6-35-14-51-52-51-95 0-71 60-155 178-155 95 0 157 69 157 142 0 98-54 170-134 170-27 0-52-15-61-31 0 0-15 57-18 68a209 209 0 0 1-25 53 249 249 0 0 0 319-238A249 249 0 0 0 250 1z"/></symbol><symbol viewBox="0 0 500 500" id="icon-twitter"><title>twitter</title><path d="M499 96c-19 8-38 14-59 16 21-12 37-32 45-56-20 12-42 20-65 25a102 102 0 0 0-174 93c-84-5-160-45-210-107a101 101 0 0 0 32 136c-17 0-33-5-47-12v1c0 49 36 90 82 100a102 102 0 0 1-46 2c13 40 51 70 95 70A205 205 0 0 1 1 407c46 29 99 45 157 45a288 288 0 0 0 290-303c20-14 37-32 51-53z"/></symbol><symbol viewBox="0 0 500 500" id="icon-whatsapp"><title>whatsapp</title><path d="M255 1A243 243 0 0 0 46 368L2 498l135-43a245 245 0 0 0 362-212C499 109 389 1 255 1zm0 444c-42 0-80-13-112-34l-78 25 25-75c-24-33-39-74-39-118 0-111 92-201 204-201s203 90 203 201-91 202-203 202zm114-147l-42-22c-5-2-10-3-14 3s-17 19-21 23c-3 4-7 5-13 1-6-3-26-10-49-32-18-17-30-38-33-44-4-6 0-10 3-13l10-10 6-10c3-4 2-8 0-11l-17-47c-5-12-10-10-14-10l-12-1c-4-1-11 1-17 7s-22 20-23 50c-1 31 20 61 23 65 3 5 40 70 103 98 62 27 62 18 74 18 11-1 37-14 43-28s6-27 5-29c-2-3-6-5-12-8z"/></symbol></svg>',a.style.display="none",b.body.appendChild(a)},mergeOptions:function(a){var b,c={selector:".share-bar",campaign:"share-bar",classPopup:"share-popup",facebookAppId:"",networks:[e,f,g,h,i,j],theme:"natural",buttonWidth:k,buttonFullWidth:l,buttonPadding:m,maxSocialButtons:n,context:"desktop",onCreateBar:function(a){return !1},onCreateButton:function(a){return !1},onShare:function(a){return !1}};a||(a={});for(b in c){c.hasOwnProperty(b)&&(this[b]=a[b]||c[b])}},validateNetworks:function(a){var b="The list of networks passed on initialization is wrong",c=0,d="",k="";if("[object Array]"!==Object.prototype.toString.call(a)){throw new Error(b+" [Should be an Array]")}for(c;c<a.length;c++){if("string"==typeof a[c]){if(d=a[c],d=d.substr(0,1).toUpperCase()+d.substr(1),k=ShareBar.prototype["create"+d+"Button"],!k){throw new Error(b+' [Network name "'+a[c]+'" is wrong, should be '+e+" or "+f+" or "+g+" or "+h+" or "+i+" or "+j+"]")}a[c]=k}else{if("function"!=typeof a[c]){throw new Error(b+" [Should be string or function]")}}}return a},createBars:function(){var a=this.containers,b=0;for(b=0;b<a.length;b++){this.createBar(a[b])}},createBar:function(a,b){var c=" share-theme-",d=0,e=0,f=[];for(b=this.validateNetworks(b||this.networks),b=b.slice(0,this.maxSocialButtons),e=b.length,f=this.getButtonsSize(a.offsetWidth,e),d;d<e;d++){b[d].call(this,a,f[d])}c+=a.getAttribute("data-theme")||this.theme,a.className+=" share-bar-container"+c,this.bindOpenPopup(a),this.bindShare(a),this.onCreateBar(a)},getButtonsSize:function(a,b){var c=this.buttonFullWidth+this.buttonPadding,d=this.buttonWidth+this.buttonPadding,e=this.isSmallScreen();return b*d>a?this.getButtonsSmall(b,d,a):e?["","","","","",""]:this.getButtonsFull(b,c,d,a)},getButtonsSmall:function(a,b,c){var d=[],e=1,f=0,g=this.isSmallScreen();for(e;e<=a;e++){f=e*b,f<=c?d[e-1]=g?"":" share-small":d[e-1]=" share-hidden"}return d},getButtonsFull:function(a,b,c,d){var e=[],f=1,g=0,h=0;for(f;f<=a;f++){g=f*b,h=(a-f)*c,h+g<=d?e[f-1]=" share-full":e[f-1]=" share-small"}return e},bindOpenPopup:function(a){var b=a.querySelectorAll("."+this.classPopup),e=0,f=this,g=function(a){f.openPopup.call(this,a)};for(e;e<b.length;e++){d(b[e],this.eventName,g),d(b[e],"click",c)}},bindShare:function(a){var b=a.querySelectorAll("."+o),c=0,e=this,f=function(a){e.onShare(this)};for(c;c<b.length;c++){d(b[c],this.eventName,f)}},openPopup:function(b){var c=a.open(this.getAttribute("href"),"popup","height=400,width=500,left=10,top=10,resizable=yes,scrollbars=no,toolbar=no,menubar=no,location=no,directories=no,status=no");c.focus()},getMetadataFromElement:function(b){var c,d=a.encodeURIComponent,e=b.getAttribute("data-url")||"",f=e.split("#"),g="?utm_source=#source#&utm_medium=share-bar-"+this.context+"&utm_campaign="+this.campaign;return c=f.length>1?f[0]+g+"&#"+f[1]:e+g,{url:d(c),title:d(b.getAttribute("data-title")||""),imageUrl:d(b.getAttribute("data-image-url")||""),hashtags:d(b.getAttribute("data-hashtags")||"")}},isSmallScreen:function(){var b=768,c=a.innerWidth||screen.width;return c<b},createButton:function(a,c,d,e,f,g){var h=b.createElement("div"),i="";return f=f||c,d=d||"",h.className=o+" share-"+c+d,f=f[0].toUpperCase()+f.slice(1),e=e.replace("%23source%23",c),g||(i=this.classPopup),h.innerHTML=['<a class="'+i+'" href="'+e+'" title="Compartilhar via '+f+'" target="_blank" rel="external">',this.createContentButton(c,f),"</a>"].join(""),a.appendChild(h),this.onCreateButton(h),h},createContentButton:function(a,b){var c;return b=b||a,c=['   <div class="svg-size">','      <svg viewBox="0 0 100 100" class="share-icon">','           <use xlink:href="#icon-'+a+'"></use>',"       </svg>","   </div>","<span>"+b+"</span>"].join("")},createFacebookButton:function(b,f){var g="",h="",i=this.getMetadataFromElement(b),j=i.url.replace("%23source%23",e);h=this.createButton(b,e,f,"http://www.facebook.com/","",!0),this.getFacebookUi(),g=function(){var b=a.decodeURIComponent;FB.ui({method:"feed",display:"popup",link:b(j),name:b(i.title),picture:b(i.imageUrl)})},d(h,this.eventName,g),d(h,"click",c)},getFacebookUi:function(){var c=this.facebookAppId||this.getOgFbAppId();return !a.FB&&void (c&&(a.fbAsyncInit=function(){FB.init({appId:c,xfbml:!0,version:"v2.8"})},function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(b,"script","facebook-jssdk")))},getOgFbAppId:function(){var a=b.querySelector("meta[property='fb:app_id']");if(null!==a){return a.getAttribute("content")}},createTwitterButton:function(a,b){var c=this.getMetadataFromElement(a);this.createButton(a,f,b,"https://twitter.com/share?url="+c.url+"&amp;text="+c.title+" "+c.hashtags)},createGoogleButton:function(a,b){var c=this.getMetadataFromElement(a);this.createButton(a,h+"plus",b,"https://plus.google.com/share?url="+c.url,h+"+")},createPinterestButton:function(a,b){var c=this.getMetadataFromElement(a);this.createButton(a,i,b,"http://br.pinterest.com/pin/create/button/?url="+c.url+"&amp;media="+c.imageUrl+"&amp;description="+c.title)},createWhatsappButton:function(a,b){var c=this.getMetadataFromElement(a);return !(!this.isSmallScreen()||!this.isTouch())&&void this.createButton(a,g,b,"whatsapp://send?text="+c.title+"%20"+c.url,"",!0)},createEmailButton:function(a,b){var c=this.getMetadataFromElement(a);return !!this.isTouch()&&void this.createButton(a,j,b,"mailto:?subject="+c.title+"&amp;body="+c.url,"e-mail",!0)}}}(window,document);(function($){var tooltipAberto=null;$.widget("glb.widgetBase",{_create:function(){},getChaveRecaptcha:function(){return"6LcsOLsSAAAAAJ1bSfGuvANCekRqzWxwYTFSJB7d"},getTemplate:function(nome,insereHtml,elemento){var html=unescape(glbComentarios.templates[nome]);if(insereHtml){if(nome.indexOf("main")!==-1){elemento.html(html)}else{elemento.append(html)}}else{this.template=html}},getCorProduto:function(){if(this.options.corProduto!==""){return this.options.corProduto}var url=window.location.href;if(url.indexOf("http://g1")!==-1){return"#A80000"}if(url.indexOf("www.techtudo")!==-1||url.indexOf("http://techtudo")!==-1){return"#FF851F"}if(url.indexOf("http://ego")!==-1){return"#F94B85"}return"#666666"},getApi:function(){if(!this.api){this.api=this.element.hasClass("glbComentarios")?this.element.comentarios("getApi"):this.element.parents(".glbComentarios").comentarios("getApi")}return this.api},getUsuario:function(){if(!this.usuario){this.usuario=this.element.hasClass("glbComentarios")?this.element.comentarios("getUsuario"):this.element.parents(".glbComentarios").comentarios("getUsuario")}return this.usuario},getTitulo:function(){return this.element.parents(".glbComentarios").comentarios("getTitulo")},setUsuario:function(usuario){this.usuario=this.element.hasClass("glbComentarios")?this.element.comentarios("setUsuario"):this.element.parents(".glbComentarios").comentarios("setUsuario",usuario)},setImagemUsuario:function($seletor,avatarImgUrl,sexo){if(avatarImgUrl){$seletor.attr("src",avatarImgUrl).load(function(){$(this).show()})}else{$seletor.removeAttr("src").hide()}},getEditoria:function(){if(!this.editoria){this.editoria=this.element.hasClass("glbComentarios")?this.element.comentarios("getEditoria"):this.element.parents(".glbComentarios").comentarios("getEditoria")}return this.editoria},getJsonTotalComentariosTopico:function(){if(!this.jsonTotalComentariosTopico){this.jsonTotalComentariosTopico=this.element.hasClass("glbComentarios")?this.element.comentarios("getJsonTotalComentariosTopico"):this.element.parents(".glbComentarios").comentarios("getJsonTotalComentariosTopico")}return this.jsonTotalComentariosTopico},getMain:function(){if(!this.main){this.main=this.element.hasClass("glbComentarios")?this.element:this.element.parents(".glbComentarios")}return this.main},getBrowserSuporta:function(elemento,propriedade){var objeto=document.createElement(elemento);return(propriedade in objeto)},getLiComentarioRaiz:function(elemento){var comentariosPais=elemento.parents("li[data-comentario-id]");var comentarioRaiz=comentariosPais.last();return comentarioRaiz},criaEventoclicouFora:function(elemento,classe,classeFechar){var self=this;var tooltipAberto=elemento;if(classe==="glbComentarios-tooltip-sair"){$(document).bind("click",function(e){if(tooltipAberto){var clicouDentroTooltip=$(e.target).hasClass(classe)||$(e.target).hasClass("glbComentarios-btn-sair");if(!clicouDentroTooltip){elemento.removeClass("on");self.removeEventoclicouFora()}}})}else{if(tooltipAberto){tooltipAberto.removeClass("on");this.removeEventoclicouFora()}tooltipAberto=elemento;$(document).bind("click.clicarfora focus.clicarfora",function(e){var clicouDentroTooltip=$(e.target).hasClass(classe)||$(e.target).parents("."+classe).hasClass(classe);var clicouBotaoFechar=$(e.target).hasClass(classeFechar);if(!clicouDentroTooltip||clicouBotaoFechar){elemento.removeClass("on");self.removeEventoclicouFora()}})}},removeEventoclicouFora:function(){tooltipAberto=null;$(document).unbind("click.clicarfora focus.clicarfora")},expirouComentario:function(hora,limite){var horaAgora=new Date().getHours();return(horaAgora-hora)>limite},_eventoAtualizaAvatar:function(){var self=this;this.getMain().bind("main.atualizaImagemAvatar",function(e,avatarImgUrl){self._atualizaImagemUsuario(avatarImgUrl)})},_fazScrollTop:function(altura,callback){altura=Math.ceil(altura);var body=$("html, body");var alturaAtual=body.scrollTop();if(altura===alturaAtual&&callback){callback();return false}body.animate({scrollTop:altura,easing:"easeOutBounce"},{duration:600,queue:false,complete:callback});return true},_atualizaImagemUsuario:function(avatarImgUrl){var seletor=$(".glbComentarios-formulario-aberto .glbComentarios-usuario-avatar");this.setImagemUsuario(seletor,avatarImgUrl,this.getUsuario().sexo)},naoImprimiveisParaEspaco:function(str){return str.replace(/[\0\n\f\r\t\v]/g," ")}})})(glb.comentarios.getJqueryComentarios());(function($){$.comentarios=(function(){var defaults={uri:null,url:null,shortUrl:null,idExterno:null,titulo:null,totalCommentsUrl:"//comentarios.globo.com/comentarios/{uri}/{idExterno}/{url}/{shorturl}/{titulo}/numero",totalUrl:"//comentarios.globo.com/comentarios/{uri}/{idExterno}/{url}/{shorturl}/{titulo}/{pagina}.json",comentariosPopulares:"//comentarios.globo.com/comentarios/{uri}/{idExterno}/{url}/{shorturl}/{titulo}/populares/{pagina}.json",denunciarUrl:"//comentarios.dinamico.globo.com/comentarios/{uri}/{idExterno}/{url}/{shorturl}/{titulo}/{idComentario}/denunciar",editoriaUrl:"//comentarios.globo.com/comentarios/editoria/{uri}",newCommentUrl:"//comentarios.dinamico.globo.com/comentarios/{uri}/{idExterno}/{url}/{shorturl}/{titulo}/{recaptchaChallenge}/{recaptchaResponse}/{texto}/novo/?comentarioPai={comentario_pai}",trocarFotoUrl:"//comentarios.dinamico.globo.com/comentarios/trocarFoto?rede_social={redeSocial}",respostasUrl:"//comentarios.globo.com/comentarios/respostas/{comentarioPai}/{pagina}.json"};var Comentarios=function(opts){this.options=$.extend({},defaults,opts);if(!this.options.uri||!this.options.titulo||!this.options.idExterno||!this.options.url){throw"A uri, título, idExterno e url do tópico são todas requeridas e precisam ser passadas como opções de mesmo nome."}this.options.uri=encodeURIComponent(this.options.uri===null?"":this.options.uri.replace(/\//g,"@@"));this.options.url=encodeURIComponent(this.options.url===null?"":this.options.url.replace(/\//g,"@@"));this.options.idExterno=encodeURIComponent(this.options.idExterno===null?"":this.options.idExterno.replace(/\//g,"@@"));this.options.titulo=encodeURIComponent(this.options.titulo===null?"":this.options.titulo.replace(/\//g,"@@"));this.options.shortUrl=encodeURIComponent(this.options.shortUrl===null?"shorturl":this.options.shortUrl.replace(/\//g,"@@"))};Comentarios.prototype._getJSON=function(opts){var _self=this;$.jsonp({url:opts.url,cache:true,callback:opts.callback_name,success:function(result){if(result.editoria){_self.editoria=result.editoria}opts.success.call(null,result)},error:function(obj,status){try{opts.error.call(null,status)}catch(erro){throw erro}}})};Comentarios.prototype.getEditoria=function(callback){var _self=this;if(this.editoria){callback.call(null,this.editoria)}else{var url=this.options.editoriaUrl.replace("{uri}",this.options.uri);this._getJSON({url:url,callback_name:"__get_editoria",success:function(editoria){_self.editoria=editoria;callback.call(null,editoria)}})}};Comentarios.prototype.getTotalComentariosTopico=function(callback){var url=this.options.totalCommentsUrl.replace("{uri}",this.options.uri).replace("{url}",this.options.url).replace("{shorturl}",this.options.shortUrl).replace("{idExterno}",this.options.idExterno).replace("{titulo}",this.options.titulo);this._getJSON({url:url,callback_name:"__callbackjsonp_verificaTotalComentarios",success:callback})};Comentarios.prototype.getComentarios=function(tipo,idUsuario,pagina,callback){var url=this.options[tipo].replace("{uri}",this.options.uri).replace("{url}",this.options.url).replace("{shorturl}",this.options.shortUrl).replace("{idExterno}",this.options.idExterno).replace("{titulo}",this.options.titulo).replace("{idUsuario}",idUsuario).replace("{pagina}",pagina);this._getJSON({url:url,callback_name:"__callback_listacomentarios",success:callback,error:callback})};Comentarios.prototype.denunciar=function(opts){var url=this.options.denunciarUrl.replace("{uri}",this.options.uri).replace("{url}",this.options.url).replace("{shorturl}",this.options.shortUrl).replace("{idExterno}",this.options.idExterno).replace("{titulo}",this.options.titulo).replace("{idComentario}",opts.idComentario);this._getJSON({url:url,callback_name:"__denunciado",success:opts.success,error:opts.error})};Comentarios.prototype.getRespostas=function(comentarioPai,pagina,success){var url=this.options.respostasUrl.replace("{comentarioPai}",comentarioPai).replace("{pagina}",pagina);this._getJSON({url:url,callback_name:"__callback_listacomentarios",success:success})};Comentarios.prototype.enviarComentario=function(opts){var url=this.options.newCommentUrl.replace("{uri}",this.options.uri).replace("{url}",this.options.url).replace("{shorturl}",this.options.shortUrl).replace("{idExterno}",this.options.idExterno).replace("{titulo}",this.options.titulo).replace("{recaptchaChallenge}",opts.recaptchaChallenge).replace("{recaptchaResponse}",opts.recaptchaResponse).replace("{texto}",encodeURIComponent(opts.texto.replace(/\//g,"@@"))).replace("{comentario_pai}",opts.comentarioPai);this._getJSON({url:url,callback_name:"__callbackjsonp_criacaoNovoPost",success:opts.success})};Comentarios.prototype.trocarFoto=function(opts){var url=this.options.trocarFotoUrl.replace("{redeSocial}",opts.redeSocial);this._getJSON({url:url,callback_name:"__trocada",success:opts.success})};return function(opts){return new Comentarios(opts)}}())})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosPaginacao",{options:{},_create:function(){this.elementos={};this._monta();this._bindsEventos()},_monta:function(){var html=['<button type="button" class="glbComentarios-botao-mais">Carregar mais comentários</button>'];this.element.append(html.join(""));this.elementos.botaoMais=this.element.find(".glbComentarios-botao-mais")},_bindsEventos:function(){var self=this;this.elementos.botaoMais.bind("click",function(e){self.element.trigger(self.options.eventoPaginacao);$(".glbComentarios").trigger("atualiza_lista")})},destroy:function(){this.elementos.botaoMais.addClass("off")},ativa:function(){this.elementos.botaoMais.removeClass("off")}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentarioStorage",$.glb.widgetBase,{options:{qtdMaxElementos:20},getComentarios:function(){return kizzy("storage").get("comentarios")},setComentarios:function(listaComentarios){return kizzy("storage").set("comentarios",listaComentarios)},verificaComentarios:function(texto){var comentarios=this.getComentarios();var podeComentar=true;texto=texto.replace(/ /g,"");if(comentarios){$.each(comentarios,function(indice,elemento){if(elemento.texto===texto){podeComentar=false;return false}})}return podeComentar},retiraExpirados:function(){var self=this;var comentarios=this.getComentarios();var listaComentarios=[];var tempoExpiracao=3;if(comentarios){$.each(comentarios,function(indice,elemento){if(!self._expirouComentario(elemento.hora,tempoExpiracao)){listaComentarios.push(elemento)}})}try{this.setComentarios(listaComentarios)}catch(e){}},adiciona:function(texto){var comentarios=[];var objComentarios={hora:new Date().getTime(),texto:texto.replace(/ /g,"")};if(this.getComentarios()){comentarios=this.getComentarios("comentarios")}if(comentarios.length<this.options.qtdMaxElementos){comentarios.push(objComentarios)}else{comentarios.shift();comentarios.push(objComentarios)}try{this.setComentarios(comentarios)}catch(e){}},_expirouComentario:function(hora,limite){var horaAgora=new Date().getTime();var intervaloHora=((horaAgora-hora)/3600000);return intervaloHora>limite},montaComentarioFake:function(texto,idComentarioPai){var usuario=this.getUsuario();var editoria=this.getEditoria();var resposta=(editoria.tipo==0)?"PREMODERADO":"POSMODERADO";var resultado={resposta:resposta,itens:[{topico:{uri:this.getApi().options.uri,url:this.getApi().options.url,titulo:this.getApi().options.titulo},texto:texto,dataCadastro:new Date().toUTCString().replace(" GMT",""),dataRFC1123:new Date().toUTCString().replace(" GMT",""),idComentario:-1,idComentarioPai:idComentarioPai,facebook_id:null,Usuario:{email:usuario.email,nome:usuario.nome,nomeFormatado:usuario.nome,sexo:usuario.sexo,uf:usuario.uf,cidade:usuario.cidade,pais:usuario.pais,usuarioId:usuario.usuarioId,avatarImgUrl:usuario.avatarImgUrl}}],editoria:{id:editoria.id,uri:editoria.uri,twitter:1,facebook:1,tipo:editoria.tipo,ordemExibComent:editoria.ordemExibComent,maxQtdAbuso:editoria.maxQtdAbuso,qtdComentPag:editoria.qtdComentPag,qtdMaxComentVisivel:editoria.qtdMaxComentVisivel},proximo_comentario_tem_captcha:usuario.proximo_comentario_tem_captcha};return resultado}})})(glb.comentarios.getJqueryComentarios());(function($){$(function(){$(".glbComentarios-aba .recentes").live("click",function(){$(".glbComentarios-aba .recentes").addClass("glbComentarios-barra-cor-produto");$(".glbComentarios-aba .populares").removeClass("glbComentarios-barra-cor-produto");$(".glbComentarios-lista-populares").css("display","none");$(".glbComentarios-lista-recentes").css("display","block")});$(".glbComentarios-aba .populares").live("click",function(){$(".glbComentarios-aba .recentes").removeClass("glbComentarios-barra-cor-produto");$(".glbComentarios-aba .populares").addClass("glbComentarios-barra-cor-produto");$(".glbComentarios-lista-recentes").css("display","none");$(".glbComentarios-lista-populares").css("display","block");$(this).trigger("mostrarPopulares")});$(".glbComentarios-aba").live("click",function(){$(".glbComentarios").trigger("atualiza_cor_aba")})})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosBotoesListar",$.glb.widgetBase,{_create:function(){this.api=this.getApi();this._leitura();this.elementos={}},_leitura:function(){var self=this;this.element.bind("botoesListar.criaBotoes",function(e,dadosBotoes){if(typeof dadosBotoes==="object"){var textoBotao="Comente agora";var botoes;var json=self.getJsonTotalComentariosTopico();var total=json.numeroDeComentarios;if(total>0){textoBotao=total+(total>1?" comentários":" comentário")}if(dadosBotoes.topo){botoes=dadosBotoes.topo;self.elementos.botaoTopo=$(dadosBotoes.topo);self.elementos.botaoTopo.addClass("glbComentarios-botao-topo").html(textoBotao)}if(dadosBotoes.baixo){if(botoes){botoes+=", "+dadosBotoes.baixo}else{botoes=dadosBotoes.baixo}self.elementos.botaoBaixo=$(dadosBotoes.baixo);self.elementos.botaoBaixo.addClass("glbComentarios-botao-baixo").html(textoBotao)}if(dadosBotoes.custom){if(botoes){botoes+=", "+dadosBotoes.custom}else{botoes=dadosBotoes.custom}}self.elementos.botoes=$(botoes);self._eventoAbreComentarios()}})},_eventoAbreComentarios:function(){var self=this;this.elementos.botoes.bind("click",function(e){self.getMain().trigger("main.abreComentarios");e.preventDefault()})}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosErro",{options:{message:null},_create:function(){var self=this;var message=self.options.message||"<strong>Ops!</strong> Alguma coisa não <br /> funcionou muito bem...";$.blockUI({message:message,baseZ:9000,css:{width:"250px",left:($(window).width()-250)/2+"px"}});$(".blockOverlay").attr("title","Clique para fechar");$(".blockMsg").addClass("blockErro").append('<button type="button" class="glbComentariosErro-btn-fecha-erro" title="Clique para fechar"></button>');$(".blockUI .glbComentariosErro-btn-fecha-erro").bind("click",function(){self.destroy()});$(".blockOverlay").bind("click",function(){self.destroy()})},destroy:function(){$.unblockUI();$.Widget.prototype.destroy.apply(this,arguments)}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosDenunciar",$.glb.widgetBase,{options:{idComentario:null,denunciarApenasLogado:false},_create:function(){var self=this;this.elementos={};this.opcoes={idComentario:self.options.idComentario,denunciarApenasLogado:self.options.denunciarApenasLogado};this.api=this.getApi();this._monta()},_monta:function(){this.elementos.li=this.element.parents("li:eq(0)");this.elementos.comentario=this.elementos.li.find(".glbComentarios-dados-usuario");this.elementos.denunciarWrapper=$(this.elementos.comentario.find(".glbComentarios-btn-denunciar-wrapper")[0]);this.elementos.botaoSim=this.elementos.denunciarWrapper.find(".glbComentarios-bt-denunciar-sim");this.elementos.botaoNao=this.elementos.denunciarWrapper.find(".glbComentarios-bt-denunciar-nao");this.opcoes.idComentario=parseInt(this.elementos.comentario.parents("li").attr("data-comentario-id").replace("comentario-",""),10);var eventos=this.eventosTooltip();eventos.init()},eventosTooltip:function(){var self=this;return{init:function(){if(this.jaDenunciado(self.opcoes.idComentario)){this.processaSucessoDenuncia({})}else{this.abre();this.selecionaNao();this.selecionaSim();if(self.opcoes.denunciarApenasLogado){self.element.comentariosLogin({eventoCallback:"denunciar.autenticacao"})}}},jaDenunciado:function(idComentario){return kizzy("denunciar").get("abuso_comentario_"+idComentario)},fecharTodos:function(){$(".glbComentarios-header").parent().unbind("click").bind("click",function(e){$(".glbComentarios-btn-denunciar-wrapper.hovered").removeClass("hovered").removeClass("on");$(".glbComentarios-btn-denunciar-wrapper .glbComentarios-bt-denunciar-sim").removeClass("on").hide();$(".glbComentarios-header").parent().unbind("click")})},abre:function(){var that=this;if(self.opcoes.denunciarApenasLogado){self.element.bind("denunciar.autenticacao",function(e){e.stopPropagation();$(".glbComentarios-btn-denunciar-wrapper.hovered").removeClass("hovered").removeClass("on");$(".glbComentarios-btn-denunciar-wrapper .glbComentarios-bt-denunciar-sim").removeClass("on").hide();that.fecharTodos();self.elementos.botaoSim.show(0,function(){$(this).addClass("on");$(this).parent().addClass("hovered")})})}else{self.element.click(function(e){e.stopPropagation();$(".glbComentarios-btn-denunciar-wrapper.hovered").removeClass("hovered").removeClass("on");$(".glbComentarios-btn-denunciar-wrapper .glbComentarios-bt-denunciar-sim").removeClass("on").hide();that.fecharTodos();self.elementos.botaoSim.show(0,function(){$(this).addClass("on");$(this).parent().addClass("hovered")})})}},selecionaNao:function(){self.elementos.botaoNao.click(function(e){$(".glbComentarios-conteudo").removeClass("hovered");self.elementos.botaoSim.removeClass("on").hide();e.preventDefault()})},reiniciaContadorDenuncia:function(){var data_ultima_denuncia=kizzy("denunciar").get("data_ultima_denuncia");if(data_ultima_denuncia===undefined){data_ultima_denuncia=0}var one_day=1000*60*60*24;if((new Date().getTime()-new Date(data_ultima_denuncia).getTime())>=one_day){kizzy("denunciar").set("data_ultima_denuncia",new Date());kizzy("denunciar").set("qtd",0)}},reportarErroAoDenunciar:function(idComentario){if(!!kizzy("denunciar").get("abuso_comentario_"+idComentario)){this.processaSucessoDenuncia({status_reportado:"ABUSO_JA_REPORTADO"})}else{if(kizzy("denunciar").get("qtd")>=10){this.processaSucessoDenuncia({status_reportado:"LIMITE_DE_DENUNCIA_ATINGIDO"})}}},podeDenunciarComentario:function(idComentario){this.reiniciaContadorDenuncia();var abuso_comentario_reportado=kizzy("denunciar").get("abuso_comentario_"+idComentario);var denuncias_abaixo_limite=kizzy("denunciar").get("qtd")===undefined||kizzy("denunciar").get("qtd")<10;return !abuso_comentario_reportado&&denuncias_abaixo_limite},marcarComoDenunciado:function(idComentario){kizzy("denunciar").set("abuso_comentario_"+idComentario,true);kizzy("denunciar").set("qtd",kizzy("denunciar").get("qtd")+1)},desabilitarBotoesDenunciar:function(){$(".glbComentarios-bt-denunciar").attr("disabled","disabled")},processaSucessoDenuncia:function(json){self.elementos.denunciarWrapper.addClass("denunciado");self.elementos.denunciarWrapper.removeClass("hovered");self.elementos.li.addClass("denunciado");self.elementos.botaoSim.removeClass("on").hide();self.elementos.mensagem=self.elementos.comentario.find(".glbComentarios-mensagem-denunciado");$(".glbComentarios-header").parent().unbind("click")},processaErroDenuncia:function(){var self=this;self.element.addClass("off");self.elementos.botaoSim.removeClass("on").hide()},selecionaSim:function(){var that=this;self.elementos.botaoSim.click(function(e){self.opcoes.success=that.processaSucessoDenuncia;self.opcoes.error=that.processaErroDenuncia;if(that.podeDenunciarComentario(self.opcoes.idComentario)){self.api.denunciar(self.opcoes);that.marcarComoDenunciado(self.opcoes.idComentario)}else{that.reportarErroAoDenunciar(self.opcoes.idComentario)}self.element.unbind();e.preventDefault()})}}}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosAvatar",$.glb.widgetBase,{options:{twitter:true,facebook:true},_create:function(){this.main=this.getMain();this.api=this.getApi();this.elementos={}}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentarios",$.glb.widgetBase,{options:{uri:null,url:null,titulo:null,idExterno:null,callbackFechaLogin:function(){},callbackAbreLogin:function(){},callbackLogado:function(){},callbackCarregado:function(){},callbackCompartilhado:function(){},shortUrl:"shorturl",comentariosVemAberto:true,botaoComentario:{topo:null,baixo:null,custom:null},exibeTeaserComentarios:false,qtdComentariosNoTeaser:6,linkVerTodosComentarios:"http://www.globo.com",corProduto:"",disclaimer:"Conforme Termo de Uso, comentários com conteúdo inadequado e spam poderão ser removidos a critério da Globo.com.",fechado:false},_create:function(){this._validaParametros();var self=this;this.botaoComentario=this.options.botaoComentario;this.elementos={};this.options.idExterno=this.options.idExterno+"";this.apiComentarios=$.comentarios({uri:this.options.uri,url:this.options.url,titulo:this.options.titulo,idExterno:this.options.idExterno,shortUrl:this.options.shortUrl});var element=this.element;this._initCadun(function(){self._verificaUsuario(element)});$(".glbComentarios").live("atualiza_cor_aba",function(){self.atualizaCorAba()});this.element.bind("main.informacoesRedeSocialUsuario",function(e,dadosOauth){self.usuario[dadosOauth.redeSocial]=dadosOauth[dadosOauth.redeSocial]});this.element.bind("main.atualizaImagemAvatar",function(e,avatarImgUrl){self.usuario.avatarImgUrl=avatarImgUrl});this.element.bind("main.abreComentarios",function(e){self._abreComentarios()});$.getScript("//comentarios.globo.com/static/widget/js/lib/recaptcha.min.js")},_verificaUsuario:function(element){var self=this;glbComentarios.proximoComentarioTemCaptcha=false;$.verificaAutenticacao(function(usuario){self.usuario=usuario;if(usuario){glbComentarios.proximoComentarioTemCaptcha=self.usuario.proximo_comentario_tem_captcha}self.getApi().getTotalComentariosTopico(function(jsonTotalComentariosTopico){self.jsonTotalComentariosTopico=jsonTotalComentariosTopico;var totalComentarios=self.jsonTotalComentariosTopico;if(self.jsonTotalComentariosTopico.bloqueado){self.options.fechado=true}else{if(self.jsonTotalComentariosTopico.permanecerAberto){self.options.fechado=false}else{if(totalComentarios.editoria.maxDiasAberto===0){self.options.fechado=true}else{if(totalComentarios.editoria.maxDiasAberto&&totalComentarios.dataCadastro){var diff=self._diferencaEmDiasParaDataCadastro(totalComentarios.dataCadastro);if(diff>=totalComentarios.editoria.maxDiasAberto){self.options.fechado=true}}}}}self.getApi().getEditoria(function(editoria){self.editoria=editoria;self._leitura(self.options.fechado);self._lancaEventos();if(self.temHashNaUrl()){self._abreComentarios()}if(self.options.fechado){$(element).children(".glbComentarios-formulario").html('<p class="glbComentariosFechados">Este conteúdo não recebe mais comentários.</p>')}})})})},_initCadun:function(callback){$.getScript("https://s.glbimg.com/pc/ca/cadun.js",function(){callback()})},recreate:function(){this.element.empty();this._create()},setUsuario:function(usuario){if(usuario){this.usuario=usuario;this.element.trigger("main.informacoesUsuario",usuario)}},atualizaCorLinks:function(){var cor=this.getCorProduto();var corOriginal="#666666";var elementos=$(".glbComentarios-link-cor");elementos.live("mouseover",function(){$(this).css("color",cor)}).live("mouseout",function(){$(this).css("color",corOriginal)})},atualizaCorAba:function(){var cor=this.getCorProduto()},getTitulo:function(){return this.options.titulo},getApi:function(){return this.apiComentarios},getUsuario:function(){return this.usuario},getEditoria:function(){return this.editoria},getJsonTotalComentariosTopico:function(){return this.jsonTotalComentariosTopico},_leitura:function(comentariosFechado){this.element.addClass("glbComentarios");if(!this.options.comentariosVemAberto){this.element.addClass("off")}this.getTemplate("main.tpl",true,this.element);this.elementos.formulario=this.element.find(".glbComentarios-formulario").html("");this.elementos.lista=this.element.find(".glbComentarios-lista-recentes").html("");this.elementos.listaPopulares=this.element.find(".glbComentarios-lista-populares").html("");this._criaInstanciaLista(comentariosFechado);var totalComentarios=this.jsonTotalComentariosTopico;if(totalComentarios.tem_ratings){this._criaInstanciaListaPopulares(comentariosFechado)}this._criaInstanciaForm();this.atualizaCorAba()},_diferencaEmDiasParaDataCadastro:function(data_cadastro){var original=new Date(data_cadastro*1000);var original=new Date(original.getUTCFullYear(),original.getUTCMonth(),original.getUTCDate(),original.getUTCHours(),original.getUTCMinutes(),original.getUTCSeconds());var actual=new Date();var delta=actual-original;return Math.floor(delta/1000/60/60/24)},_criaInstanciaForm:function(){this.elementos.formulario.comentariosForm()},_pegaOptionsComTeaser:function(comentariosFechado){return{qtdComentariosNoTeaser:this.options.qtdComentariosNoTeaser,linkVerTodosComentarios:this.options.linkVerTodosComentarios,callbackLogado:this.options.callbackLogado,callbackCarregado:this.options.callbackCarregado,callbackCompartilhado:this.options.callbackCompartilhado,disclaimer:this.options.disclaimer,fechado:comentariosFechado}},_pegaOptionsSemTeaser:function(){return{linkVerTodosComentarios:this.options.linkVerTodosComentarios,callbackLogado:this.options.callbackLogado,callbackCarregado:this.options.callbackCarregado,callbackCompartilhado:this.options.callbackCompartilhado,disclaimer:this.options.disclaimer}},_criaInstanciaListaPopulares:function(comentariosFechado){var options;if(this.options.exibeTeaserComentarios){options=this._pegaOptionsComTeaser(comentariosFechado);options.populares=true;this.elementos.listaPopulares.comentariosLista(options)}else{options=this._pegaOptionsSemTeaser();options.populares=true;this.elementos.listaPopulares.comentariosLista(options)}},_criaInstanciaLista:function(comentariosFechado){var options;if(this.options.exibeTeaserComentarios){options=this._pegaOptionsComTeaser(comentariosFechado);this.elementos.lista.comentariosLista(options)}else{options=this._pegaOptionsSemTeaser();this.elementos.lista.comentariosLista(options)}},_validaParametros:function(){var msgErroCaracteres=" caracteres. Quando não deveria ter mais do que ";this.options.disclaimer=this.options.disclaimer||"";if(this.options.disclaimer!==$.glb.comentarios.prototype.options.disclaimer){this.options.disclaimer=this.options.disclaimer.replace(/<\/?\w+(\s+)?[^>]*>/g,"");this.options.disclaimer=this.options.disclaimer.substr(0,115)}if(!this.options.uri||!this.options.titulo||!this.options.idExterno||!this.options.url){throw new Error("As propriedades: uri, url, título, idExterno do tópico são obrigatórias")}if(this.options.url.length>255){throw new Error("A url possui "+this.options.url.length+msgErroCaracteres+"255")}if(this.options.uri.length>1200){throw new Error("A uri possui "+this.options.uri.length+msgErroCaracteres+"1200")}if(this.options.titulo.length>255){throw new Error("O titulo possui "+this.options.titulo.length+msgErroCaracteres+"255")}if(this.options.idExterno.length>50){throw new Error("O idExterno possui "+this.options.idExterno.length+msgErroCaracteres+"50")}if(typeof this.options.callbackLogado!=="function"||typeof this.options.callbackCompartilhado!=="function"||typeof this.options.callbackCarregado!=="function"||typeof this.options.callbackAbreLogin!=="function"||typeof this.options.callbackFechaLogin!=="function"){throw new Error("As callbacks passadas não são funções válidas")}if(this.options.shortUrl.length>100){this.options.shortUrl=this.options.shortUrl.substring(0,90)}if(typeof this.options.qtdComentariosNoTeaser!=="number"){throw new Error("O parâmetro qtdComentariosNoTeaser deveria ser um número")}if(typeof this.options.botaoComentario!=="object"){throw new Error("O parâmetro botaoComentario deveria ser um objeto")}},_lancaEventos:function(){if(this.botaoComentario.topo||this.botaoComentario.baixo||this.botaoComentario.custom){this.element.comentariosBotoesListar();this.element.trigger("botoesListar.criaBotoes",this.botaoComentario)}},_abreComentarios:function(){this.element.removeClass("off");var alturaScroll=this.element.offset().top-80;this.element.addClass("ativo");$("html, body").animate({scrollTop:alturaScroll,easing:"easeOutBounce"},{duration:1200,queue:false})},temHashNaUrl:function(){if(window.location.hash==="#comentarios"){return true}return false}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosForm",$.glb.widgetBase,{options:{comentarioPai:0,callbackAbreLogin:function(){},callbackFechaLogin:function(){},textoInicial:""},_create:function(){var self=this;this.elementos={};this._monta();this._eventoAutenticacao();this._criaJanelaLogin();this.tipoEditoria={preModerada:0,posModerada:1};this.elementos.textArea.comentariosTextarea({comentarioPai:self.options.comentarioPai,maxlength:600,elementClass:"glbComentarios-textarea-contador",invalidClass:"glbComentarios-textarea-invalido",formulario:self.element});this.elementos.avatar.comentariosAvatar({twitter:1,facebook:1});if(this.getUsuario()){this._atualizaInformacoesUsuario(this.getUsuario())}this._bindEventos()},destroy:function(){$.Widget.prototype.destroy.call(this,arguments);this.element.html("")},_monta:function(){this.getTemplate("formulario.tpl",true,this.element);this.elementos.formInicial=this.element.find(".glbComentarios-dados-form-interno");this.elementos.formAberto=this.element.find(".glbComentarios-formulario-aberto");this.elementos.textArea=this.element.find(".glbComentarios-widget-comentarios-texto");this.elementos.avatar=this.elementos.formAberto.find(".glbComentarios-usuario-anonimo-avatar");this.elementos.captcha=this.element.find(".glbComentarios-captcha");this.elementos.submit=this.element.find(".glbComentarios-botaoEnviar");this.elementos.formAberto.attr("id","glbComentarios-principal-captcha")},_criaJanelaLogin:function(){var self=this;this.elementos.formInicial.comentariosLogin({eventoCallback:"form.eventoCallbackAutenticacao",callbackAbreLogin:self.options.callbackAbreLogin,callbackFechaLogin:self.options.callbackFechaLogin})},_montaRecaptcha:function(){if(glbComentarios.proximoComentarioTemCaptcha){this.elementos.captcha.recaptchaGoogle()}},_eventoAutenticacao:function(){var self=this},_eventoEnviaComentario:function(){var self=this;var teclas={enter:13};this.elementos.captcha.bind("keypress",function(e){if(self._validaCampos()){self.elementos.submit.removeClass("off")}if(e.keyCode==teclas.enter){self.elementos.submit.trigger("click")}});this.elementos.submit.bind("click",function(){if(!$(this).hasClass("off")&&self._validaCampos()){self._enviarComentario()}})},_eventoAtualizaInformacoesUsuario:function(){var self=this;this.getMain().bind("main.informacoesUsuario",function(e,usuario){self._atualizaInformacoesUsuario(usuario)})},_bindEventos:function(){var self=this;this._eventoEnviaComentario();this._eventoAtualizaInformacoesUsuario()},_validaCampos:function(){var self=this;var texto=this.elementos.textArea.val();var captcha=this.element.find("#recaptcha_response_field").val();var valido=true;var existeCaracter=/[^\s]/.test(texto);if(!existeCaracter){self.elementos.textArea.addClass("erro");valido=false}else{if(!captcha&&this.elementos.captcha.is(":visible")){self.elementos.captcha.find("input").addClass("erro");valido=false}else{if(this.elementos.textArea.hasClass("erro")){valido=false}}}return valido},_enviarComentario:function(){var self=this;var recaptchaResponse=$("#recaptcha_response_field",this.elementos.captcha).val()||"sem-captcha";var recaptchaChallenge=$("#recaptcha_challenge_field",this.elementos.captcha).val()||"sem-captcha";var texto=self.elementos.textArea.val();this.storage=this.element.find(".glbComentarios-formulario-aberto").comentarioStorage();this.storage.comentarioStorage("retiraExpirados");var podeComentar=this.storage.comentarioStorage("verificaComentarios",texto);if(podeComentar){this.getApi().enviarComentario({recaptchaChallenge:recaptchaChallenge,recaptchaResponse:recaptchaResponse,texto:texto,comentarioPai:this.options.comentarioPai||"",success:function(resultado){self._processaResposta(self,resultado,texto)}})}else{resultado=this.storage.comentarioStorage("montaComentarioFake",texto,this.options.comentarioPai);self._processaResposta(self,resultado,texto)}return},_processaResposta:function(self,resultado,texto){glbComentarios.proximoComentarioTemCaptcha=resultado.proximo_comentario_tem_captcha;switch(resultado.resposta){case"PREMODERADO":self._respostaEnviarComentario(self,resultado,texto);self._limpaFormulario();break;case"POSMODERADO":self._respostaEnviarComentario(self,resultado,texto);self._limpaFormulario();break;case"captcha-invalido":self.elementos.captcha.trigger("recaptchaGoogle.captchaInvalido");self.element.removeClass("glbComentarios-sem-captcha");break;case"texto-invalido":self.elementos.captcha.trigger("recaptchaGoogle.reloadImagem");break;case"comentario-fechado":self.getMain().comentariosErro({message:"Desculpe, comentários foram fechados para esse conteúdo."});break;default:self.getMain().comentariosErro();break}},_respostaEnviarComentario:function(self,resultado,texto){self.storage.comentarioStorage("adiciona",texto);self.getMain().find(".glbComentarios-lista").trigger("lista.novoComentario",[resultado,this.options.comentarioPai])},_reloadRecaptcha:function(){if(this.elementos.captcha.is(":visible")){this.elementos.captcha.trigger("recaptchaGoogle.reloadImagem")}},_limpaFormulario:function(){var self=this;self.elementos.textArea.val("");self.elementos.textArea.focusout();self.elementos.textArea.keyup();self.elementos.formInicial.removeClass("ativo off")},_atualizaInformacoesUsuario:function(usuario){$(".glbComentarios-dados-usuario-nome",this.element).text(usuario.nome);if(usuario.cidade!==""){$(".glbComentarios-dados-usuario-localizacao",this.element).text(usuario.cidade+", "+usuario.uf)}else{if(usuario.pais!==""){$(".glbComentarios-dados-usuario-localizacao",this.element).text(usuario.pais)}}this._atualizaImagemUsuario(usuario.avatarImgUrl,usuario)}})})(glb.comentarios.getJqueryComentarios());(function($){var Tracker={UA:"",trackerName:"",whiteList:["techtudo.com.br","musica.com.br","globoi.com"],init:function(){if(!Tracker.shouldTurnOn()){return}var toggleVisibility=function(){if(!Tracker.boxComentarios.length){return}var visibilityStart=Tracker.boxComentarios.offset().top;var actualPosition=$(document).scrollTop()+$(window).height();var fitOnWindow=$(window).width()>=1250;if(actualPosition>=visibilityStart&&fitOnWindow){Tracker.registerViewedComments()}};try{Tracker.registerPagewithComments()}catch(err){}$(window).scroll(function(){if(window.COMENTARIO_VISIVEL){return}toggleVisibility()});Tracker.bindEvents()},trackEventName:function(){if(Tracker.trackerName){return Tracker.trackerName+"._trackEvent"}return"_trackEvent"},registerPagewithComments:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Pagina com Comentarios",window.location.href,0,true])},registerViewedComments:function(){window.COMENTARIO_VISIVEL=true;_gaq.push([Tracker.trackEventName(),"Comentarios","Viu Area Comentarios",window.location.href,0,true])},registerPopularTab:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Aba Populares",window.location.href,0,true])},registerRecentesTab:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Aba Recentes",window.location.href,0,true])},registerClickInNewCommentBox:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Clique box comentario",window.location.href])},registerSubmitNewComment:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Sucesso",window.location.href])},registerShareToFacebook:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Social","Facebook - Share"])},registerShareToTwitter:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Social","Twitter - Share"])},registerClickInDenounce:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Denunciar","Intencao",0,true])},registerSubmitDenounce:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Denunciar","Sucesso",0,true])},registerSubmitThumbsUp:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Thumbs","Up",0,true])},registerSubmitThumbsDown:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Thumbs","Down",0,true])},registerPagination:function(){_gaq.push([Tracker.trackEventName(),"Comentarios","Mais Comentarios"])},shouldTurnOn:function(){var whitelisted=false;var key;for(key in Tracker.whiteList){if(window.location.hostname.indexOf(Tracker.whiteList[key])!=-1){whitelisted=true;break}}if(!whitelisted&&window.location.hostname.indexOf("globo.com")==-1){return false}if(typeof _gat==="undefined"||typeof _gaq==="undefined"){return false}t=_gat._getTrackerByName(Tracker.trackerName);if(t._getAccount()!=Tracker.UA){if(!whitelisted){return false}Tracker.trackerName=""}return true},bindEvents:function(){var that=this;Tracker.boxComentarios.delegate(".populares","click",function(){that.registerPopularTab()});Tracker.boxComentarios.delegate(".recentes","click",function(){that.registerRecentesTab()});Tracker.boxComentarios.delegate(".glbComentarios-formulario-texto-inicial","focus",function(){that.registerClickInNewCommentBox()});Tracker.boxComentarios.delegate(".glbComentarios-botaoEnviar","click",function(){that.registerSubmitNewComment()});Tracker.boxComentarios.delegate(".glbComentarios-bt-facebook","click",function(){that.registerShareToFacebook()});Tracker.boxComentarios.delegate(".glbComentarios-bt-twitter","click",function(){that.registerShareToTwitter()});Tracker.boxComentarios.delegate(".glbComentarios-bt-denunciar","focus",function(){that.registerClickInDenounce()});Tracker.boxComentarios.delegate(".glbComentarios-bt-denunciar-sim","click",function(){that.registerSubmitDenounce()});Tracker.boxComentarios.delegate(".glbComentarios-thumbs-up","click",function(){that.registerSubmitThumbsUp()});Tracker.boxComentarios.delegate(".glbComentarios-thumbs-down","click",function(){that.registerSubmitThumbsDown()});Tracker.boxComentarios.delegate(".glbComentarios-botao-mais","click",function(){that.registerPagination()})},trackingStarted:false,startTracking:function(boxComentarios){if(window._gaq===undefined){window._gaq=[]}if(!window.hasOwnProperty("_gaq")){window._gaq=[]}if(!Tracker.trackingStarted){Tracker.boxComentarios=boxComentarios;Tracker.trackingStarted=true}}};window.COMENTARIO_VISIVEL=false})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosTextarea",$.glb.widgetBase,{options:{comentarioPai:0,maxlength:100,formulario:null},_create:function(){this.element.elastic();this._applyCharacterCount();this.bindFocus();this.bindFocusout();this.CHAVE_RECAPTCHA=this.getChaveRecaptcha()},_addCounterHtml:function(){var html='<span class="glbComentario-textarea-contador"></span>'},bindFocus:function(){var self=this;this.element.bind("focus",function(){$(".glbComentarios-btn-denunciar-wrapper.hovered").removeClass("hovered").removeClass("on");$(".glbComentarios-btn-denunciar-wrapper .glbComentarios-bt-denunciar-sim").removeClass("on").hide();self._ativaCaptcha();$(this).closest(".glbComentarios-formulario-resposta").addClass("glbComentarios-formulario-resposta-focus")});$(".glbComentarios-formulario").delegate("#novoResponseField","focus",function(){$(".glbComentarios-btn-denunciar-wrapper.hovered").removeClass("hovered").removeClass("on");$(".glbComentarios-btn-denunciar-wrapper .glbComentarios-bt-denunciar-sim").removeClass("on").hide();$(this).closest(".glbComentarios-formulario-resposta").addClass("glbComentarios-formulario-resposta-focus")})},bindFocusout:function(){var self=this;this.element.bind("focusout",function(){if(this.value===""){var formResposta=$(this).closest(".glbComentarios-formulario-resposta");formResposta.removeClass("glbComentarios-formulario-resposta-focus");formResposta.find(".glbComentarios-recaptcha-principal").hide();formResposta.find(".ativo").removeClass("ativo");var captcha=$(this).parents(".glbComentarios-dados-form-interno").find(".glbComentarios-captcha");captcha.trigger("recaptchaGoogle.destroyCaptcha")}})},_ativaCaptcha:function(){if(glbComentarios.proximoComentarioTemCaptcha){Captcha.seleciona(this.options.formulario,this.options.comentarioPai);this.options.formulario.find(".glbComentarios-captcha").show()}},_applyCharacterCount:function(){var self=this;this._addCounterHtml()}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.recaptchaGoogle",{options:{idCaptchaNaPagina:"0",classeContainer:"glbComentarios-recaptcha-principal",textoLabelCaracteres:"Digite as palavras a seguir:"},_init:function(){this.elementos={};this._leitura();this._bindEventos()},_leitura:function(){var html=['<div id="glbComentarios-recaptcha-',this.options.idCaptchaNaPagina,'" class="',this.options.classeContainer,'">','<label for="recaptcha_response_field">',this.options.textoLabelCaracteres,"</label>",'<div class="recaptcha_container">','<input type="text" name="recaptcha_response_field" id="recaptcha_response_field" maxlength="200" />','<div class="glbComentarios-recaptcha-imagem">','<div id="recaptcha_image"></div>',"</div>",'<div class="recaptcha_actions">','<button type="button" class="recaptcha_reload">',"Atualizar imagem","</button>","</div>","</div>","</div>"];this.element.html(html.join(""));this.input=this.element.find(".recaptcha_response_field")},_criaRecapthaGoogle:function(){if($(".glbComentarios-reduced").length!==0){this.element.find("label").text("Digite as palavras abaixo:")}var RecaptchaComentarios={optionsRecaptcha:{theme:"custom",lang:"pt"},load:function(context){Recaptcha.create("6LcsOLsSAAAAAJ1bSfGuvANCekRqzWxwYTFSJB7d",context,this.optionsRecaptcha)}};RecaptchaComentarios.load("glbComentarios-recaptcha-"+this.options.idCaptchaNaPagina)},_destroyRecapthaGoogle:function(){this.element.hide();this.element.empty()},_bindEventos:function(){var self=this;this.element.unbind();this.element.find(".glbComentarios-recaptcha-principal .recaptcha_reload").click(function(){self._reloadCaptcha()});this.element.bind("recaptchaGoogle.reloadImagem",function(){self._reloadCaptcha()});this.element.bind("recaptchaGoogle.createCaptcha",function(){self._criaRecapthaGoogle()});this.element.bind("recaptchaGoogle.captchaInvalido",function(){self.element.find("input").addClass("erro");self._reloadCaptcha()});this.element.find(".glbComentarios-recaptcha-principal").keydown(function(){if(!!$(this).text()){self.element.find("input").removeClass("erro")}});this.element.bind("recaptchaGoogle.destroyCaptcha",function(){self._destroyRecapthaGoogle()})},_reloadCaptcha:function(){Recaptcha.context="glbComentarios-recaptcha-"+this.options.idCaptchaNaPagina;Recaptcha.widget=Recaptcha.$("recaptcha_image");Recaptcha.reload()}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosCompartilhar",$.glb.widgetBase,{_create:function(){this._bindClick()},_bindClick:function(){var self=this;$(".glbComentarios-lista").delegate(".glbComentarios-bt-twitter","click",function(){self._compartilha($(this),"twitter")});$(".glbComentarios-lista").delegate(".glbComentarios-bt-facebook","click",function(){self._compartilha($(this),"facebook")})},_compartilha:function(elemento,redeSocial){var liPai=this.getLiComentarioRaiz(elemento);var li=elemento.parents("li:eq(0)");var url=decodeURIComponent(location.href).split("#!")[0];var hashComentarioId="#!"+li.attr("id");url+=hashComentarioId;var nome=li.find("strong.glbComentarios-dados-usuario-nome:eq(0)").text();var texto=li.find(".glbComentarios-conteudo-interno .glbComentarios-texto-comentario:eq(0)").text();var id=li.attr("id").split("comentario-")[1];var postUrl="//comentarios.dinamico.globo.com/redesocial/share/"+redeSocial+"/"+id+"/";$.jsonp({url:postUrl,cache:true,callback:"__callback_compartilha_redesocial"});switch(redeSocial){case"twitter":this._compartilhaTwitter(texto,nome,url,li);break;case"facebook":var ehResposta=false;if(liPai.attr("id")!==li.attr("id")){ehResposta=true}this._compartilhaFacebook(texto,nome,url,li,ehResposta);break}},_cortaTexto:function(texto,limite){if(limite&&texto.length>limite){limite--;var ultimo=texto.substr(limite-1,1);while(ultimo!==" "&&limite>0){limite--;ultimo=texto.substr(limite-1,1)}ultimo=texto.substr(limite-2,1);if(ultimo===","||ultimo===";"||ultimo===":"){texto=texto.substr(0,limite-2)+"..."}else{if(ultimo==="."||ultimo==="?"||ultimo==="!"){texto=texto.substr(0,limite-1)}else{texto=texto.substr(0,limite-1)+"..."}}}return texto},_formataTexto:function(texto,limite){texto=this._cortaTexto($.trim(texto),limite);texto='"'+texto+'"';return texto},_compartilhaTwitter:function(texto,nome,url,li){var urlShareTwitter="http://twitter.com/intent/tweet?&text=";var creditos=" por "+nome+" | ";var limite=(135-(creditos.length+20));texto=this._formataTexto(texto,limite);urlShareTwitter+=encodeURIComponent(texto+creditos+url);this._popin(urlShareTwitter)},_buscaImagensFacebook:function(){var metas=$("meta[property='og:image']");var imagens=[];for(i=0;i<metas.length;i++){imagens.push($(metas[i]).attr("content"))}return imagens},_compartilhaFacebook:function(texto,nome,url,li,ehResposta){var titulo=this.getTitulo();var urlShareFacebook="http://www.facebook.com/sharer/sharer.php?s=100&p[title]=";var creditos=nome;creditos+=(ehResposta)?" respondeu: ":" comentou: ";var chamada=(ehResposta)?" — Veja o comentário que deu origem a esta resposta.":"";var limite=(295-(creditos.length+chamada.length));texto=this._formataTexto(texto,limite).replace(/#|/g,"");urlShareFacebook+=encodeURIComponent(titulo).replace(/'/g,"%27");urlShareFacebook+="&p[summary]="+encodeURIComponent(creditos+texto+chamada);urlShareFacebook+="&p[url]="+encodeURIComponent(url);var imagensFacebook=this._buscaImagensFacebook();if(imagensFacebook!=[]){for(var i=0;i<imagensFacebook.length;i++){urlShareFacebook+="&p[images]["+i+"]="+encodeURIComponent(imagensFacebook[i])}}this._popin(urlShareFacebook)},_popin:function(url){open(url,"sharer","width=800, height=600")}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosOauth",$.glb.widgetBase,{options:{nenhuma:false,twitter:true,facebook:true,escolherSomenteUmaRede:false,callbackAposEstadoClicado:null},_create:function(){this.ID_RANDOMICO="comentarios"+this.element.attr("id")+"-"+Math.random();this.URL_OAUTH_REDE_SOCIAL="//comentarios.dinamico.globo.com/autenticacao/redesocial/{rede_social}/?id_random_post_message={id_random_post_message}&url={success_url}";this.IE8_TARGET_IFRAME="//comentarios.globo.com/comentarios/ie8_posmsg/"+encodeURIComponent(window.location.href.split("#")[0]);this.TIPO_ESTADO={INEXISTENTE:-1,ASSOCIAR:1,CLICAR:2,CLICADO:3,ERRO:4,DESASSOCIADO:5};this.REDE_SOCIAL={nenhuma:{NOME:"nenhuma",ESTADO:(this.options.nenhuma?this.TIPO_ESTADO.CLICAR:this.TIPO_ESTADO.INEXISTENTE)},facebook:{NOME:"facebook",ESTADO:(this.options.facebook?this.TIPO_ESTADO.ASSOCIAR:this.TIPO_ESTADO.INEXISTENTE)},twitter:{NOME:"twitter",ESTADO:(this.options.twitter?this.TIPO_ESTADO.ASSOCIAR:this.TIPO_ESTADO.INEXISTENTE)}};this.TODAS_REDES_SOCIAIS_ATIVAS=[];this.elementos={};this.main=this.getMain();this.api=this.getApi();this.usuario=this.getUsuario();this._gerarVariavelTodasRedesSociais();var self=this;$.each(this.TODAS_REDES_SOCIAIS_ATIVAS,function(key,redeSocial){self._gerarHtml(redeSocial);self._configurarEventos(redeSocial);self._adicionarEventoReferenteAoEstadoRedeSocialEspecifica(redeSocial)});this._receberPostMessage();if(this.getUsuario()){this._atualizaPluginComRedesSociaisUsuario(this.getUsuario())}this.getMain().bind("main.informacoesUsuario",function(e,usuario){self._atualizaPluginComRedesSociaisUsuario(usuario)});this.getMain().bind("main.informacoesRedeSocialUsuario",function(e,dadosOauth){self._atualizaPluginComRedeSocialEspecificaUsuario(dadosOauth)})},_atualizaPluginComRedesSociaisUsuario:function(usuario){var self=this;$.each(this.TODAS_REDES_SOCIAIS_ATIVAS,function(key,redeSocial){self._configurarRedeSocialEspecifica(usuario,redeSocial)})},_atualizaPluginComRedeSocialEspecificaUsuario:function(dadosOauth){if(this.options[dadosOauth.redeSocial]){this._configurarRedeSocialEspecifica(dadosOauth,dadosOauth.redeSocial)}},_gerarVariavelTodasRedesSociais:function(){var self=this;$.each(this.REDE_SOCIAL,function(key,redeSocial){if(self.options[redeSocial.NOME]){self.TODAS_REDES_SOCIAIS_ATIVAS.push(redeSocial.NOME)}})},_gerarHtml:function(redeSocial){var template='<button type="button" class="glbComentarios-btn-{rede_social}">{rede_social}</button>';this.element.append(template.replace(/\{rede_social\}/g,redeSocial))},_configurarEventos:function(redeSocial){var self=this;this.element.delegate(".glbComentarios-btn-"+redeSocial+".clicar","click",function(){if(self.usuario){self.oauthFacebook=!!self.usuario.facebook.isAutorizado}self._setEstadoClicado(redeSocial);self._adicionarEventoReferenteAoEstadoRedeSocialEspecifica(redeSocial)});this.element.delegate(".glbComentarios-btn-"+redeSocial+".clicado","click",function(){self.REDE_SOCIAL[redeSocial].ESTADO=self.TIPO_ESTADO.CLICAR;self._adicionarEventoReferenteAoEstadoRedeSocialEspecifica(redeSocial)});this.element.delegate(".glbComentarios-btn-"+redeSocial+".associar","click",function(e){if($(this).hasClass("clicar")){return}if(self.usuario){self.oauthFacebook=!!self.usuario.facebook.isAutorizado}var urlVolta=encodeURIComponent(window.location.toString().split("#")[0]);var urlOauth=self.URL_OAUTH_REDE_SOCIAL.replace("{id_random_post_message}",encodeURIComponent(self.ID_RANDOMICO)).replace("{rede_social}",redeSocial).replace("{success_url}",urlVolta);window.open(urlOauth)})},_adicionarEventoReferenteAoEstadoRedeSocialEspecifica:function(redeSocial){var self=this;this.element.find(".glbComentarios-btn-"+redeSocial).removeClass("clicar clicado");switch(this.REDE_SOCIAL[redeSocial].ESTADO){case this.TIPO_ESTADO.CLICAR:this.element.find(".glbComentarios-btn-"+redeSocial).addClass("clicar");break;case this.TIPO_ESTADO.CLICADO:this.element.find(".glbComentarios-btn-"+redeSocial).addClass("clicado");if(this.oauthFacebook){return}this.api.trocarFoto({redeSocial:redeSocial,success:function(resposta){if(resposta.resultadoTroca==="SUCESSO"){self.main.trigger("main.atualizaImagemAvatar",resposta.avatarImgUrl)}}});break;default:this.element.find(".glbComentarios-btn-"+redeSocial).addClass("associar")}},_receberPostMessage:function(){var self=this;$.receiveMessage(function(message){var dados=$.parseJSON(message.data);if(dados.idRandomPostMessage!==self.ID_RANDOMICO){return}self.getMain().trigger("main.informacoesRedeSocialUsuario",dados)},"//comentarios.dinamico.globo.com",500,self.IE8_TARGET_IFRAME);this.comunicacao_registrada=true},_configurarRedeSocialEspecifica:function(dadosPost,redeSocial){if((dadosPost[redeSocial]&&dadosPost[redeSocial].isAutorizado)||(this.options.nenhuma&&redeSocial==="nenhuma")){if(dadosPost.idRandomPostMessage&&(dadosPost.idRandomPostMessage==this.ID_RANDOMICO)){this._setEstadoClicado(redeSocial)}else{this.REDE_SOCIAL[redeSocial].ESTADO=this.TIPO_ESTADO.CLICAR}}else{this.REDE_SOCIAL[redeSocial].ESTADO=this.TIPO_ESTADO.ASSOCIAR}this._adicionarEventoReferenteAoEstadoRedeSocialEspecifica(redeSocial)},getRedesSociaisClicadas:function(){var redesSociaisClicadas={};var self=this;$.each(self.TODAS_REDES_SOCIAIS_ATIVAS,function(key,redeSocial){if(self.REDE_SOCIAL[redeSocial].ESTADO==self.TIPO_ESTADO.CLICADO){redesSociaisClicadas[redeSocial]=true}else{redesSociaisClicadas[redeSocial]=false}});return redesSociaisClicadas},_setEstadoClicado:function(redeSocial){this.REDE_SOCIAL[redeSocial].ESTADO=this.TIPO_ESTADO.CLICADO;if(this.options.callbackAposEstadoClicado){this.element.trigger(this.options.callbackAposEstadoClicado,redeSocial)}if(this.options.escolherSomenteUmaRede){this.REDE_SOCIAL[redeSocial].ESTADO=this.TIPO_ESTADO.CLICAR}}})})(glb.comentarios.getJqueryComentarios());(function(global,$){global.Thumbs=global.Thumbs||{};var InteractivityList=function(container){this.container=container};InteractivityList.prototype={init:function(){this.ulElement=this.container.find("ul.glbComentarios-lista-todos");this.getVotes();this.bindEvents()},bindEvents:function(){var self=this;var evento="atualiza_lista";$(".glbComentarios").unbind(evento).bind(evento,function(){self.updateAllInteractivities()})},getUrl:function(){var url=this.ulElement.find("input[name='url-get-interatividade']").val();var agregador=this.ulElement.find("input[name='agregador']").val();url=url+"/notas/agregador/"+agregador+"/resultado-resumido.jsonp";return url},getVotes:function(){var self=this;var url=this.getUrl();this.result=[];$.jsonp({url:url,cache:true,callback:"resultado_resumido_agregador",success:function(result){self.result=result;self.updateAllInteractivities()}})},updateAllInteractivities:function(){var self=this;for(var i=0;i<self.result.length;i++){var interactivity=self.result[i];var votes=interactivity.opcoes;this.updateVotes(votes,interactivity.interatividade)}},updateVotesFromLocalStorage:function(idInteractivity,element){var key=idInteractivity,optionId=kizzy("thumbs-votes").get(key),value=0;if(optionId!==undefined){var optionElements=element.find(".glbComentarios-thumbs[data-opcao-id="+optionId+"]");optionElements.each(function(indice,item){var optionElement=$(item);value=optionElement.text();value=parseInt(value,10)+1;optionElement.text(value);smokyOtherButton(optionElement)})}},updateVotes:function(data,idInteractivity){var item,element=$("li[data-interatividade-id="+idInteractivity+"]");for(var i=0;i<data.length;i++){item=data[i];var optionId=item.opcao_id;var value=item.qtd_votos;var optionElement=element.find(".glbComentarios-thumbs[data-opcao-id="+optionId+"]");optionElement.text(value)}this.updateVotesFromLocalStorage(idInteractivity,element)}};global.Thumbs.InteractivityList=InteractivityList;var Vote=function(element){this.element=$(element);this.val=parseInt(this.element.text(),10)};Vote.prototype={add:function(){if(this.valid()){this.registerVote()}return this.val},getTokenUrl:function(){var url=this.element.parents("ul").find("input[name='url-get-interatividade']").val();url=url+"/notas/token.jsonp";return url},getToken:function(callback){var self=this;var url=this.getTokenUrl();$.jsonp({url:url,cache:true,callback:"get_token",success:function(result){self.token=result.token;callback(self.token)},error:function(obj,status){self.token="0";callback(self.token)}})},valid:function(){if(this.userVotedInInteractivity()){return false}if(validSize()){incrStorage();return true}if(!validSize()&&validDateMoreThanHour()){clearSize();clearDate();incrStorage();return true}return false},userVotedInInteractivity:function(){var voted=false;if(this.hasVoteInInteractivity()){voted=true}if(this.hasVoteInOption()){voted=true}return voted},send:function(){var self=this;this.getToken(function(token){self._send(token)})},_send:function(token){var url=this.getInteractivityUrl();json={interatividade_id:this.getInteractivityId(),votos:[{opcao_id:this.getOptionId(),nota:1}],recaptcha_challenge_field:"",recaptcha_response_field:"",token_notas:token};var dataPost=JSON.stringify(json);if(isIE()){sendIE(url,dataPost)}else{sendWithAjax(url,dataPost)}},getInteractivityUrl:function(){var url="";var urlInteractivityPost=this.element.parents("ul").find("input[name='url-post-interatividade']").val();url=urlInteractivityPost+"/notas/votar";return url},getInteractivityId:function(){return parseInt(this.element.parents("li").attr("data-interatividade-id"),10)},getOptionId:function(){if(this.element.hasClass("glbComentarios-thumbs-up")){return parseInt(this.element.attr("data-opcao-id"),10)}else{if(this.element.hasClass("glbComentarios-thumbs-down")){return parseInt(this.element.attr("data-opcao-id"),10)}}},registerVote:function(){setThumbOptionForUser(this.getInteractivityId(),this.getOptionId());smokyOtherButton(this.element);this.val+=1;this.send()},hasVoteInInteractivity:function(){var keyThumbs="thumbs-votes";var voteInInteractivity=kizzy(keyThumbs).get(this.getInteractivityId());if(voteInInteractivity){return true}return false},hasVoteInOption:function(){var keyThumbs="thumbs-votes";var voteInInteractivity=kizzy(keyThumbs).get(this.getInteractivityId());if(voteInInteractivity){return voteInInteractivity===this.getOptionId()}return false}};function sendWithAjax(url,dataPost){$.ajax({type:"POST",url:url,dataType:"json",data:dataPost,error:function(jqXHR,textStatus,errorThrown){}})}function sendIE(url,dataPost){var xdr=new XDomainRequest();xdr.open("POST",url);xdr.send(dataPost);xdr.onerror=function(){};xdr.onload=function(){var dom=new ActiveXObject("Microsoft.XMLDOM");dom.async=false;dom.loadXML(xdr.responseText)}}function isIE(){return window.XDomainRequest}function validSize(){var MAX_SIZE=30;var size=get_key_or_0("size");if(size<MAX_SIZE){return true}return false}function validDataMoreThan(interval){var date=get_key_or_0("date");var deltaTime=new Date().getTime()-new Date(date).getTime();if(deltaTime>interval){return true}return false}function validDateMoreThanDay(){var ONE_DAY=1000*60*60*24;return validDataMoreThan(ONE_DAY)}function validDateMoreThanHour(){var ONE_HOUR=1000*60*60;return validDataMoreThan(ONE_HOUR)}function incrStorage(){kizzy("thumbs").set("size",(get_key_or_0("size")+1));var date=get_key_or_0("date");if(date===0){clearDate()}}function clearDate(){kizzy("thumbs").set("date",new Date())}function clearSize(){kizzy("thumbs").set("size",0)}function setThumbOptionForUser(interativityId,optionId){var keyThumbs="thumbs-votes";kizzy(keyThumbs).set(interativityId,optionId)}function get_key_or_0(key){var size=kizzy("thumbs").get(key);if(size===undefined){size=0}return size}function smokyOtherButton(element){var otherOption=$(element).siblings(".glbComentarios-thumbs");$(otherOption).removeClass("voted");$(otherOption).addClass("smoky");$(otherOption).die("click")}global.Thumbs.Vote=Vote})(window,glb.comentarios.getJqueryComentarios());(function($){$(function(){$(".glbComentarios-thumbs-down").live("click",function(){var addedValue=new Thumbs.Vote(this).add();$(this).text(addedValue)});$(".glbComentarios-thumbs-up").live("click",function(){var addedValue=new Thumbs.Vote(this).add();$(this).text(addedValue)})})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosLogin",$.glb.widgetBase,{options:{eventoCallback:null,classeBoxLogin:"widget-comentario-box-login",eventoJanelaLoginEscuta:"click",callbackAbreLogin:function(){},callbackFechaLogin:function(){}},_create:function(){this._criaJanelaLogin();this._bindEventos()},_criaJanelaLogin:function(){var self=this;this.element.janelaLogin({evento:this.options.eventoJanelaLoginEscuta,servico:3004,site:window.location.toString()+"#comentarios",classes:{boxLogin:this.options.classeBoxLogin,autenticado:"ativo"},success:function(usuario){if(!self.getUsuario()){self.setUsuario(usuario)}self.element.trigger(self.options.eventoCallback,usuario)}})},_bindEventos:function(){var self=this;this.element.bind("loginshow",function(event,$box){var larguraDispositivo=$(window).width();larguraDispositivo=self._isIPhoneOrIpodOrIpad()?window.innerWidth:larguraDispositivo;larguraDispositivo=self._isAndroid()?screen.width:larguraDispositivo;var top=0;var left=(larguraDispositivo-parseInt($box.style.width,10))/2;$.blockUI({message:$box,fadeIn:1250,baseZ:9000,css:{top:top,left:left,width:"350px",border:"none"},overlayCSS:{cursor:"default",opacity:0.5}});$(".blockOverlay").attr("title","Clique para fechar o login");$("iframe",$box).ready(function(){$(".blockMsg").prepend('<div class="glbComentarios-login-btn-fecha-login" title="Clique para fechar o login"></div>');$(".blockUI .glbComentarios-login-btn-fecha-login").bind("click",function(){self.options.callbackFechaLogin();self.element.janelaLogin("close")})});$(".blockOverlay").bind("click",function(){self.options.callbackFechaLogin();self.element.janelaLogin("close")});self.element.parent().scrollTop(9999);if(self._isIPhoneOrIpodOrIpad()||self._isAndroid()){window.scrollTo(0,0)}return false});this.element.bind("loginclose",function(event,$box){$.unblockUI()})},_isIPhoneOrIpodOrIpad:function(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)},_isAndroid:function(){return navigator.userAgent.match(/Android/i)}})})(glb.comentarios.getJqueryComentarios());(function($){$.widget("glb.comentariosLista",$.glb.widgetBase,{options:{qtdComentariosNoTeaser:null,linkVerTodosComentarios:null,populares:false,callbackLogado:function(){},callbackCarregado:function(){},callbackCompartilhado:function(){},disclaimer:"Conforme Termo de Uso, comentários com conteúdo inadequado e spam poderão ser removidos a critério da Globo.com.",fechado:false},_create:function(){this._template();this.eventoPaginacao=this.options.populares?"lista.mostraMaisPopulares":"lista.mostraMais";this.MAXIMO_TEASER_RESPOSTAS=2;this.CHAVE_RECAPTCHA=this.getChaveRecaptcha();this.api=this.getApi();this.usuario=this.getUsuario();this.elementos={};this.pagina=1;this.comentarioCompartilhado=this._temComentarioCompartilhado();this.comentarioCompartilhadoJaFoiPincado=false;this.getMain();this.element.comentariosCompartilhar();this._inicializa();this._executaLista();this._bindEventos();this.interactivities=new Thumbs.InteractivityList(this.element)},getMaximoTeaserResposta:function(){return this.MAXIMO_TEASER_RESPOSTAS},_bindEventos:function(){this._bindNovoComentario();this._bindAtualizaInformacoesUsuario();this._eventoAtualizaAvatar();this._bindClickPaginarRespostas()},_carregarAvatar:function(liComentario){var avatarImgUrl=liComentario.attr("data-usuario-avatarimgurl");var avatar=liComentario.find(".glbComentarios-usuario-avatar:eq(0)");if(avatarImgUrl){avatar.attr("src",avatarImgUrl);avatar.load(function(){$(this).addClass("visivel")})}},_temFormResposta:function(){return this.elementos.hasOwnProperty("formResposta")},_destroyFormResposta:function(){if(this._temFormResposta()){this.elementos.formResposta.comentariosForm("destroy")}},_criaBotaoPaginacaoResposta:function(){var html=[""];if(this.qtd_replies>2){var maximoTeaserResposta=2;var totalRespostas=this.qtd_replies-maximoTeaserResposta;html=['<button type="button" class="glbComentarios-lista-bt-paginar">',"<span>Ver Mais ",totalRespostas," comentário",totalRespostas>1?"s":"","</span>","</button>"]}return html.join("")},getQtdRespostasFaltam:function(totalRespostas){if(totalRespostas>this.itensPorPagina){totalRespostas=this.itensPorPagina}return totalRespostas},_interaBotaoPaginacaoResposta:function(json,fn){$.each(json.itens,function(indice,elemento){elemento._criaBotaoPaginacaoResposta=fn})},_montaResposta:function(pagina,qtdRespostas,botao,container,comentario,json){var self=this;botao.attr("disabled",true);this._interaBotaoPaginacaoResposta(json,this._criaBotaoPaginacaoResposta);var listaPai=this.element.find("ul");var urlPostInteratividade=listaPai.find("input[name=url-post-interatividade]").val();var urlGetInteratividade=listaPai.find("input[name=url-get-interatividade]").val();var replyTemplate=this.template.replace("{>reply}","");json.urlPostInteratividade=urlPostInteratividade;json.urlInteratividade=urlGetInteratividade;var htmlReply=Mustache.to_html(replyTemplate,json);if(pagina===1){container.html(htmlReply)}else{container.prepend(htmlReply)}this._limparBarraThumbsShare(this._temInteratividade(json));container.find("li").each(function(){var liComentario=$(this);self._insereDadosFormatados(liComentario);self._carregarAvatar(liComentario)});this._denunciar();this._destacaComentarioUsuario(container);var comentariosRestantes=Math.abs(container.find("li").length-qtdRespostas);if(comentariosRestantes>json.itensPorPagina){comentariosRestantes=json.itensPorPagina}if(comentariosRestantes===0){botao.hide()}else{botao.text("Ver Mais "+comentariosRestantes+(comentariosRestantes>1?" comentários":" comentário"))}if(this.options.fechado&&pagina===1){container.find("li:last-child .glbComentarios-conteudo-interno").addClass("remove-line")}comentario.attr("data-reply-pagina",pagina+1);botao.attr("disabled",false);$(".glbComentarios").trigger("atualiza_lista");$(".glbComentarios-lista-resposta .glbComentarios-aba.interno").remove()},_paginaRespostas:function(botao){var comentario=botao.parents("li:first");var comentarioPai=comentario.attr("data-comentario-id").substr(11);var qtdRespostas=parseInt(comentario.attr("data-comentario-qtd_replies"),10);var pagina=parseInt(comentario.attr("data-reply-pagina"),10)||1;var self=this;this.api.getRespostas(comentarioPai,pagina,function(json){var container=botao.parent().find("ul:first");self._montaResposta(pagina,qtdRespostas,botao,container,comentario,json);$(".glbComentarios").trigger("atualiza_lista")})},_bindClickPaginarRespostas:function(){var self=this;this.element.delegate(".glbComentarios-lista-bt-paginar","click",function(e){self._paginaRespostas($(this));e.preventDefault()})},_fecharThreadAberta:function(botao,listaResposta){botao.removeClass("on");listaResposta.hide()},_setIdPai:function(idPai){if(!this.usuario){this.idPai=idPai}},_montaResponder:function(li){var idPai=li.attr("id").split("comentario-")[1];var listaResposta=li.find(".glbComentarios-lista-resposta:eq(0)");var nomeUsuarioRespondido=li.find(".glbComentarios-dados-usuario-nome").text();var containerFormulario=li.find(".glbComentarios-formulario-resposta");if(!containerFormulario.length){li.append('<div class="glbComentarios-formulario-resposta glbComentarios-sem-captcha" />');containerFormulario=li.find(".glbComentarios-formulario-resposta")}this._setIdPai(idPai);if(this.options.fechado){var qtdRespostas=parseInt(listaResposta.attr("data-total-replies"));if(qtdRespostas===0){listaResposta.parent().addClass("remove-line")}else{listaResposta.find("li:last-child .glbComentarios-conteudo-interno").addClass("remove-line")}}else{containerFormulario.attr("id","glbComentarios-responder-captcha").comentariosForm({comentarioPai:idPai,textoInicial:this._insereNomeNaResposta(nomeUsuarioRespondido)})}containerFormulario.find(".glbComentarios-widget-comentarios-texto").attr("placeholder","Entre na conversa");this.elementos.formResposta=containerFormulario},_insereNomeNaResposta:function(nomeUsuarioRespondido){nomeUsuarioRespondido=nomeUsuarioRespondido||"";if(nomeUsuarioRespondido){nomeUsuarioRespondido=nomeUsuarioRespondido+" "}return nomeUsuarioRespondido},_scrollResponder:function(elemento,callback){if(elemento.hasClass("off")&&elemento.siblings(".glbComentarios-formulario-aberto")){elemento=elemento.siblings(".glbComentarios-formulario-aberto")}this._colocarElementoNoMeioDaTela(elemento,callback)},_colocarElementoNoMeioDaTela:function(elemento,callback){if(elemento.offset().hasOwnProperty("top")){var metadeDaTela=$(window).height()/2;var metadeDoElemento=elemento.height()/2;var alturaScroll=elemento.offset().top-(metadeDaTela-metadeDoElemento);var self=this;setTimeout(function(){self._fazScrollTop(alturaScroll,callback)},100)}},_temComentarios:function(){return !!this.numeroDeComentarios},_template:function(){this.getTemplate("lista.tpl",false)},_deveCriarPaginacao:function(){return(this.limitePaginas>1&&this.numeroDeComentarios>0)},_temComentarioCompartilhado:function(){var hash=location.hash;var comentarioCompartilhado;if(hash){var hashParts=hash.split("#");for(var i=hashParts.length-1;i>=0;i--){var hashWithComentarioId=hashParts[i].split("comentario-")[1];if(hashWithComentarioId){comentarioId=hashWithComentarioId.split("?")[0];comentarioCompartilhado=comentarioId;break}}}return comentarioCompartilhado},_requisitaAtualizaQtdLido:function(id){var redeSocial=this._retornaRedeSocialOrigem();var deveAtualizarQtdLido=!!redeSocial;if(deveAtualizarQtdLido){var url="//comentarios.dinamico.globo.com/compartilha/"+redeSocial+"/atualiza-qtd-lido/"+id+"/";$.jsonp({url:url,cache:false,callback:"__callback_atualiza_qtd_lido"})}},_retornaRedeSocialOrigem:function(){var urlOrigem=document.referrer;var redeSocial;if(urlOrigem.indexOf("facebook")>=0){redeSocial="facebook"}else{if(urlOrigem.indexOf("twitter")>=0){redeSocial="twitter"}}return redeSocial},_inicializa:function(){this.totalComentariosTopico=this.getJsonTotalComentariosTopico();if(this.totalComentariosTopico.bloqueado){this._setTitulo("comentários")}if(this.totalComentariosTopico.totalPaginas){this.numeroDeComentarios=this.totalComentariosTopico.numeroDeComentarios;this.totalPagina=this.totalComentariosTopico.totalPaginas;this.limitePaginas=this.totalComentariosTopico.limitePaginas;this._pluralizaTitulo();this._adicionaAba()}},_pluralizaTitulo:function(){if(this.numeroDeComentarios>0){this._setTitulo(this.numeroDeComentarios>1?" comentários":" comentário");this.main.find(".glbComentarios-contador").html(this.numeroDeComentarios)}},_setTitulo:function(texto){this.main.find(".glbComentarios-texto-contador").html(texto);$(".glbComentarios-texto-contador").removeClass("glbComentarios-zerado")},_adicionaAba:function(){var aba=$(".glbComentarios-aba");var recentes=$(".glbComentarios-aba .recentes");var populares=$(".glbComentarios-aba .populares");var header=$(".glbComentarios-header div");var temRatings=this.totalComentariosTopico.tem_ratings;if(temRatings){recentes.html("recentes");recentes.addClass("glbComentarios-barra-cor-produto");populares.html("populares");header.removeClass("glbComentarios-barra-cor-produto");aba.removeClass("glbComentarios-sem-ratings")}},_requestPeloEvento:function(service,usuarioId){var self=this;this.api.getComentarios(service,usuarioId,self.pagina,function(json){self._monta(json);self.options.callbackCarregado()})},estouNoIEVersao:function(versao){var rv=-1;if(navigator.appName=="Microsoft Internet Explorer"){var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(re.exec(ua)!==null){rv=parseFloat(RegExp.$1)}}return(rv>0&&rv<=versao)},_requestListaTotal:function(){var self=this;var usuarioId=null;var service="totalUrl";if(this._usuarioLogado()){usuarioId=this.usuario.usuarioId}if(self.options.populares){service="comentariosPopulares";if(self.estouNoIEVersao(9)){$(".glbComentarios-aba .populares").live("mostrarPopulares",function(event){self._requestPeloEvento(service,usuarioId);event.stopPropagation();$(".glbComentarios-aba .populares").die("mostrarPopulares")});return}}this.api.getComentarios(service,usuarioId,this.pagina,function(json){self._monta(json);self.options.callbackCarregado()})},_executaLista:function(){this._requestListaTotal()},_getComentarioCompartilhado:function(idComentarioCompartilhado,callback,args){var url="//comentarios.social.globo.com/redesocial/comentario/"+idComentarioCompartilhado;var self=this;self.montaCallback=callback;self.montaCallbackArgs=args;$.jsonp({url:url,cache:true,callback:"__callback_comentariosocial",success:function(json){var comentarioCompartilhado=json.itens[0];comentarioCompartilhado.compartilhado=true;self.montaCallbackArgs.itens.splice(0,0,comentarioCompartilhado);self.comentarioCompartilhadoJaFoiPincado=true;self._requisitaAtualizaQtdLido(self.comentarioCompartilhado);self.options.callbackCompartilhado();self.montaCallback.apply(self,[self.montaCallbackArgs])},error:function(){self.montaCallback.apply(self,[self.montaCallbackArgs]);self.comentarioCompartilhadoJaFoiPincado=true}})},_colocaComentarioCompartilhadoNoTopoDaLista:function(lista,idComentario){lista=lista.slice();var index=this._getIndexDeComentarioNaLista(lista,idComentario);var comentario;if(index!==-1){comentario=lista[index];lista.splice(index,1);comentario.compartilhado=true}if(comentario!==undefined){lista.splice(0,0,comentario)}return lista},_pincaComentarioCompartilhado:function(response,idComentarioCompartilhado,callback){if(this._getIndexDeComentarioNaLista(response.itens,idComentarioCompartilhado)!==-1){response.itens=this._colocaComentarioCompartilhadoNoTopoDaLista(response.itens,idComentarioCompartilhado);this.comentarioCompartilhadoJaFoiPincado=true;callback.apply(this,[response])}else{this._getComentarioCompartilhado(idComentarioCompartilhado,callback,response)}},_removeComentarioDaLista:function(lista,idComentario){lista=lista.slice();var idx=this._getIndexDeComentarioNaLista(lista,this.comentarioCompartilhado);if(idx>-1){lista.splice(idx,1)}return lista},_getIndexDeComentarioNaLista:function(lista,idComentario){for(var index=0;index<lista.length;index++){if(lista[index].idComentario==idComentario){return index}}return -1},_monta:function(json){if(this.comentarioCompartilhado===undefined){this._executaMonta(json);return}if(this.comentarioCompartilhadoJaFoiPincado){json.itens=this._removeComentarioDaLista(json.itens,this.comentarioCompartilhado);this._executaMonta(json)}else{this._pincaComentarioCompartilhado(json,this.comentarioCompartilhado,this._executaMonta)}},_executaMonta:function(json){this.totalComentariosPagina=json.itens.length;this.itensPorPagina=json.itensPorPagina;this._interaBotaoPaginacaoResposta(json,this._criaBotaoPaginacaoResposta);this._geraHtmlTodos(json);if(this.pagina===1){this._montaTeaser()}this._montaBotaoVerTodos();this._controlaPaginacao();this._denunciar();this._montaElementos();this._montaPaginacao();if(this._deveCriarPaginacao()){this._criaPaginacao()}},_montaElementos:function(){var self=this;var elementos=this.element.find('ul[class^="glbComentarios-lista"] > li');elementos.each(function(indice,elemento){var liComentario=$(elemento);var id=parseInt(liComentario.attr("data-usuario-id").split("-")[1],10);var deveAtualizarAvatar=(self._usuarioLogado()&&self.usuario.usuarioId===id);if(deveAtualizarAvatar){var avatarImgUrl=self.usuario.avatarImgUrl}self._carregarAvatar(liComentario);self._insereDadosFormatados(liComentario);self._criaBotaoListaRespostas(liComentario)});if(!!self.usuario){this.main.trigger("main.atualizaImagemAvatar",self.usuario.avatarImgUrl)}this._destacaComentarioUsuario()},_criaBotaoListaRespostas:function(elemento,atualiza){var temBotaoListaResposta=elemento.find(".glbComentarios-bt-lista-respostas").length;if(temBotaoListaResposta&&!atualiza){return false}var totalDeRespostas=parseInt(elemento.find(".glbComentarios-lista-resposta:eq(0)").attr("data-total-replies"),10);var botaoResponder=elemento.find(".glbComentarios-bt-responder:eq(0)");if(totalDeRespostas>=1){if(temBotaoListaResposta&&atualiza){var quantidadeRespostas=totalDeRespostas+(totalDeRespostas>1?" comentários":" comentário");elemento.find(".glbComentarios-bt-lista-respostas").text(quantidadeRespostas)}else{var htmlBotaoMaisRespostas=['<button type="button" class="glbComentarios-btn glbComentarios-link-cor glbComentarios-bt-lista-respostas'+(atualiza?" on":"")+'">',totalDeRespostas,(totalDeRespostas>1?" comentários":" comentário"),"</button>"];botaoResponder.after(htmlBotaoMaisRespostas.join(""))}botaoResponder.hide()}else{if(this.options.fechado){botaoResponder.hide();botaoResponder.parent().find(".thumbs-to-responder").hide()}}return true},_incrementaQtdDeRespostasNoBotao:function(elemento){var qtdAtual=parseInt(elemento.attr("data-comentario-qtd_replies"),10);var qtdAtualizada=qtdAtual+1;elemento.attr("data-comentario-qtd_replies",qtdAtualizada);elemento.find(".glbComentarios-lista-resposta:eq(0)").attr("data-total-replies",qtdAtualizada);this._criaBotaoListaRespostas(elemento,true)},_usuarioLogado:function(){return !!this.usuario},_temTeaser:function(){return !!this.element.find("li.off").length},_controlaPaginacao:function(){var self=this;var temTeaserComUmaPagina=(self.pagina===1&&self.limitePaginas===1);this.element.unbind(self.eventoPaginacao).bind(self.eventoPaginacao,function(){if(!self._temTeaser()){self.pagina++;if(self.pagina===self.limitePaginas){self.element.comentariosPaginacao("destroy")}self._executaLista()}else{if(temTeaserComUmaPagina){self._abreTeaser();self.element.comentariosPaginacao("destroy")}else{if(self._temTeaser()){self._abreTeaser()}}}})},_temPaginacao:function(){return this.elementos.hasOwnProperty("botaoMais")},_montaPaginacao:function(){var precisaDePaginacao=(this.totalPagina>1&&this.limitePaginas>1&&!this._temPaginacao())||this._temTeaser();if(precisaDePaginacao){this._criaPaginacao()}},_criaPaginacao:function(){this.element.comentariosPaginacao({eventoPaginacao:this.eventoPaginacao});this.elementos.botaoMais=this.element.find("button.glbComentarios-botao-mais")},_getTodos:function(json){var objeto={};if(json.length){objeto={};objeto.itens=json}else{objeto.itens=[]}return objeto},_listaTodosCriada:function(){return this.elementos.hasOwnProperty("ulTodos")},_alterarTemplateParaReply:function(){var templateLimpo=this._alteraTemplateSemUlContainer();templateLimpo=this._limpaTemplateResposta(templateLimpo);templateLimpo=templateLimpo.replace("{{#itens}}","").replace("{{/itens}}","").replace('<div class="formulario" data-id="{{idComentario}}"> </div>',"");return templateLimpo},_limpaTemplateResposta:function(template){var templateLimpo=template.replace("{{{_criaBotaoPaginacaoResposta}}}","").replace("{{#replies}}","").replace("{{>reply}}","").replace("{{/replies}}","");return templateLimpo},_alteraTemplateSemUlContainer:function(){var templateLimpo=this.template.replace('<ul class="glbComentarios-lista-todos">',"").replace("</ul >","");return templateLimpo},_geraHtmlTodos:function(json){var listaTodos=this._getTodos(json.itens);var tamanhoLista=listaTodos.itens.length;listaTodos.urlPostInteratividade=json.urlPostInteratividade;listaTodos.urlInteratividade=json.urlInteratividade;listaTodos.agregador=json.agregador;if(tamanhoLista<=0){return}var reply_template=this._alterarTemplateParaReply();var htmlTodos=Mustache.to_html(this.template,listaTodos,{reply:reply_template});var container=this.elementos.ulTodos;if(this._listaTodosCriada()){container.append($(htmlTodos).find("> li"))}else{container=this.element.prepend(htmlTodos);container=container.find("> ul")}var self=this;container.find("> li").each(function(idx,li){self._montaResponder($(li))});this._limparBarraThumbsShare(this._temInteratividade(json));self._initiateShareBar(json.facebook_app_id);$(".glbComentarios-lista-resposta .glbComentarios-aba").remove();this.elementos.ulTodos=this.elementos.ulTodos||this.element.find("> ul:eq(0)");if(this.totalComentariosTopico.tem_ratings){this.interactivities.init();this._acertaSelecaoAba()}else{this._removeAbasInternasDeRecenteEPopulares()}},_temInteratividade:function(json){return json.itens.length>0?json.itens[0].temInteratividade:false},_limparBarraThumbsShare:function(temInteratividade){if(temInteratividade){this.element.find(".glbComentarios-lista-resposta-todos .glbComentarios-barra-share").remove()}else{this.element.find(".glbComentarios-lista-resposta-todos .glbComentarios-btns-thumb-share").remove()}},_acertaSelecaoAba:function(){if(this.options.populares){this.elementos.ulTodos.parent().find(".glbComentarios-aba.interno .recentes").removeClass("glbComentarios-barra-cor-produto");this.elementos.ulTodos.parent().find(".glbComentarios-aba.interno .populares").addClass("glbComentarios-barra-cor-produto")}},_removeAbasInternasDeRecenteEPopulares:function(){this.elementos.ulTodos.parent().find(".glbComentarios-aba.interno p").remove();this.elementos.ulTodos.parent().find(".glbComentarios-aba.interno").css("margin-bottom","15px")},_montaTeaser:function(){var precisaDeTeaser=this.options.qtdComentariosNoTeaser&&(this.options.qtdComentariosNoTeaser<this.totalComentariosPagina);if(precisaDeTeaser){var offAPartirDo=this.options.qtdComentariosNoTeaser;this.element.find(".glbComentarios-lista-todos > li").slice(offAPartirDo).addClass("off");this._criaPaginacao()}},_abreTeaser:function(){this.element.find("li.off").removeClass("off")},_montaBotaoVerTodos:function(){var temLimiteDePaginas=!!this.getEditoria().qtdMaxComentVisivel;var temComentariosDepoisLimite=this.totalPagina>this.limitePaginas;var atingiuLimitePaginas=this.pagina===this.limitePaginas;var precisaCriarBotao=temLimiteDePaginas&&atingiuLimitePaginas&&temComentariosDepoisLimite&&!!this.options.linkVerTodosComentarios;if(precisaCriarBotao){var botaoVerTodos=['<a href="',this.options.linkVerTodosComentarios,'"','rel="external" title="Ver todos os comentários" class="glbComentarios-lnk-ver-todos">',"Ver todos os comentários","</a>"];this.element.append(botaoVerTodos.join(""));this.elementos.botaoVerTodos=this.element.find(".glbComentarios-lnk-ver-todos")}},_denunciar:function(){if(this.elementos.ulTodos){this.elementos.ulTodos.find("li .glbComentarios-bt-denunciar").comentariosDenunciar()}},_insereDadosFormatados:function(elemento){var data=elemento.find(".glbComentarios-data abbr");var id=parseInt(elemento.attr("data-usuario-id").split("-")[1],10);var sexo=elemento.attr("data-usuario-sexo");var avatarUsuario=elemento.find(".glbComentarios-usuario-anonimo-avatar > div");var avatarImgUrl=elemento.attr("data-usuario-avatarimgurl");var deveAtualizarAvatar=(this._usuarioLogado()&&this.usuario.usuarioId===id);if(deveAtualizarAvatar){avatarImgUrl=this.usuario.avatarImgUrl}this.setImagemUsuario(avatarUsuario,avatarImgUrl,sexo);this._converteData(data)},marretadaPorContaDoJsonRespostaNoBanco:function(elemento){var listOfDays=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"];elemento.each(function(index,item){item=$(item);var dataString=item.attr("title");for(var i=0;i<listOfDays.length;i++){dataString=dataString.replace(listOfDays[i]+",","")}item.attr("title",dataString)})},_converteData:function(elemento){this.marretadaPorContaDoJsonRespostaNoBanco(elemento);elemento.timeago()},_listaMontada:function(){return !!(this.elementos.ulTodos||this.elementos.ulNovoComentario)},_destacaComentarioUsuario:function(lista){if(this._usuarioLogado()&&this._listaMontada()){lista=lista||this.element;this.elementos.usuario=lista.find('li[data-usuario-id="usuario-'+this.usuario.usuarioId+'"]').addClass("glbComentarios-logado");this.elementos.usuario.find('.glbComentarios-btn-denunciar-wrapper[data-denunciar-usuario-id="denunciar-usuario-'+this.usuario.usuarioId+'"] .glbComentarios-bt-denunciar').remove()}},_montaMensagemNotificacao:function(json){var html=[];var mensagem="<p>"+this.options.disclaimer+"</p>";html='<div class="glbComentarios-mensagem-notificacao">'+mensagem+"</div>";return html},_removeShareDoComentario:function(comentarioElement){comentarioElement.find(".glbComentarios-barra-share").remove()},_diferenciaComentarioNovoPreModerado:function(comentarioElement){comentarioElement.addClass("pre-moderado")},_criaNotificacao:function(json,temPai){var html="";var idComentario=json.itens[0].idComentario;var comentario=this.element.find("#comentario-"+idComentario);if(json.resposta=="PREMODERADO"){this._removeShareDoComentario(comentario);this._diferenciaComentarioNovoPreModerado(comentario)}var liComentario=comentario.find(".glbComentarios-dados-usuario");if(idComentario==-1){liComentario=$(liComentario[0])}liComentario.append(this._montaMensagemNotificacao(json))},_temListaNovoComentario:function(){return this.elementos.hasOwnProperty("ulNovoComentario")},_temListaComentarioCompartilhado:function(){return !!this.elementos.ulComentarioCompartilhado.length},_listaEstaVazia:function(){return this.element.is(":empty")},_bindNovoComentario:function(){var self=this;this.element.bind("lista.novoComentario",function(evento,json,idComentarioPai){self._montaNovoComentario(json,idComentarioPai)})},_montaNovoComentario:function(json,idComentarioPai){var itens=json.itens[0]||json.itens;if(idComentarioPai){this._montaNovoComentarioComPai(json,idComentarioPai)}else{this._montaNovoComentarioSemPai(json)}$(".glbComentarios-lista-resposta .glbComentarios-aba.interno").remove();$(".glbComentarios .novo .glbComentarios-btns-thumb-share").remove();$(".glbComentarios .glbComentarios-lista-novo-comentario .glbComentarios-btns-thumb-share").remove()},_montaNovoComentarioComPai:function(json,idPai){var comentarioPai=this.element.find("#comentario-"+idPai);if(comentarioPai.length!==0){var listaComentarioPai=comentarioPai.find(".glbComentarios-lista-resposta:eq(0) > .glbComentarios-lista-resposta-todos");var html=Mustache.to_html(this.template,json);listaComentarioPai.append(html);var novoComentario=listaComentarioPai.find("li:last");novoComentario.addClass("novo");this._carregarAvatar(novoComentario);this._criaNotificacao(json,true);this._insereDadosFormatados(novoComentario);this._destacaComentarioUsuario(listaComentarioPai);this._incrementaQtdDeRespostasNoBotao(comentarioPai)}},_montaNovoComentarioSemPai:function(json,classCompartilhado){var container=this.elementos.ulNovoComentario;var temComentarioAnterior=this._temListaNovoComentario();var deveCriarLista=!temComentarioAnterior||(temComentarioAnterior&&this._temListaComentarioCompartilhado());var deveCriarAvatar=!classCompartilhado;var deveCompartilhar=!!classCompartilhado;classCompartilhado=classCompartilhado||"";var template="";if(classCompartilhado){template=this._alteraTemplateSemUlContainer();json.itens[0].idComentario=json.itens[0].idComentario+"-compartilhado"}else{template=this._alteraTemplateSemUlContainer();template=this._limpaTemplateResposta(template)}if(deveCriarLista){this.element.find(".glbComentarios-compartilhado").remove();container=this.element;template='<ul class="glbComentarios-lista-novo-comentario '+classCompartilhado+'">'+template+"</ul>"}var reply_template=this._alterarTemplateParaReply();var html=Mustache.to_html(template,json,{reply:reply_template});container.prepend(html);this.elementos.ulNovoComentario=this.element.find(".glbComentarios-lista-novo-comentario");this.elementos.ulComentarioCompartilhado=this.element.find(".glbComentarios-compartilhado");var novoComentario=this.elementos.ulNovoComentario.find("> li:eq(0)");this._carregarAvatar(novoComentario);this._insereDadosFormatados(novoComentario);if(!classCompartilhado){this._criaNotificacao(json)}else{var listaResposta=novoComentario.find('.glbComentarios-lista-resposta:not([data-total-replies="0"]):eq(0)');listaResposta.addClass("sempre-visivel")}this._destacaComentarioUsuario();this._animaNovoComentario(novoComentario,temComentarioAnterior,deveCompartilhar)},_animaNovoComentario:function(elemento,temComentarioAnterior,compartilhado){if(compartilhado){elemento.show();this._colocarElementoNoMeioDaTela(elemento)}else{elemento.slideDown(350)}},_bindAtualizaInformacoesUsuario:function(){var self=this;this.main.bind("main.informacoesUsuario",function(evento,usuario){var loginEmReply=(self.idPai&&!self.usuario);self.usuario=usuario;if(loginEmReply){self._destacaComentarioUsuario();self.options.callbackLogado()}else{self._removeElementos(function(){self._executaLista();self._destacaComentarioUsuario();self._montaTeaser();self.element.comentariosPaginacao("ativa");self.options.callbackLogado()})}})},_removeElementos:function(callback){var elementos=["ulTodos","botaoMais"];var self=this;var ulTodos=this.elementos.ulTodos;self.element.comentariosPaginacao("destroy");if(ulTodos){ulTodos.parent().find(".glbComentarios-aba.interno").remove();ulTodos.remove();delete this.elementos.ulTodos}if(callback){callback()}},_initiateShareBar:function(facebookAppId){var tipoLista=this.element.hasClass("glbComentarios-lista-recentes")?"recentes":"populares";this.element.find(".glbComentarios-barra-share").each(function(idx,shareElement){if(shareElement.innerHTML===""){var comentarioId=shareElement.getAttribute("data-comentario-id");var parentElement=$(shareElement).parents(".glbComentarios-dados-usuario");var usuario=parentElement.find(".glbComentarios-dados-usuario-nome").text().split(" ")[0];var textoUsuario=parentElement.find(".glbComentarios-texto-comentario").text();if(textoUsuario.length>80){textoUsuario=textoUsuario.slice(0,80)+" ..."}var msgShare=usuario+' comentou "'+textoUsuario+'"';shareElement.setAttribute("data-title",msgShare);shareElement.setAttribute("data-hashtags",document.location.href+"#comentario-"+comentarioId);shareElement.setAttribute("data-url",document.location.href+"#comentario-"+comentarioId);shareElement.setAttribute("data-image-url",document.location.href);$(".glbComentarios-lista-"+tipoLista+" .glbComentarios-share-"+comentarioId).empty();new ShareBar({facebookAppId:facebookAppId,selector:".glbComentarios-lista-"+tipoLista+" .glbComentarios-share-"+comentarioId,theme:"minimal",networks:["facebook","twitter","whatsapp","google"]})}});if(tipoLista==="populares"){$(".glbComentarios-lista-populares .glbComentarios-barra-share .share-button").removeClass("share-hidden").addClass("share-full")}}})})(glb.comentarios.getJqueryComentarios());